#define __COMPILE_0
#define __COMPILE_1
#define __COMPILE_2
#define __COMPILE_3
#define __COMPILE_4
#define __COMPILE_5
#define __COMPILE_6
#define __COMPILE_7
#define __COMPILE_8
#define __COMPILE_9
#define __COMPILE_10
#define __COMPILE_11
#define __COMPILE_12
#define __COMPILE_13
#define __COMPILE_14
#define __COMPILE_15
#define __COMPILE_16
#define __COMPILE_17
#define __COMPILE_19
#define __COMPILE_20
#define __COMPILE_21
#define __COMPILE_22
#define __COMPILE_23
#define __COMPILE_24
#define __COMPILE_25
#define __COMPILE_26
#define __COMPILE_27
#define __COMPILE_28
#define __COMPILE_29
#define __COMPILE_30
#define __COMPILE_31
#define __COMPILE_32
#define __COMPILE_33
#define __COMPILE_34
#define __COMPILE_35
#define __COMPILE_36
#define __COMPILE_37
#define __COMPILE_38
#define __COMPILE_39
#define __COMPILE_40
#define __COMPILE_41
#define __COMPILE_42
#define __COMPILE_43
#define __COMPILE_44
#define __COMPILE_45
#define __COMPILE_46
#define __COMPILE_47
#define __COMPILE_48
#define __COMPILE_49
#define __COMPILE_50
#define __COMPILE_51
#define __COMPILE_52
#define __COMPILE_53
#define __COMPILE_54
#define __COMPILE_55
#define __COMPILE_56
#define __COMPILE_57
#define __COMPILE_58
#define __COMPILE_59
#define __COMPILE_60
#define __COMPILE_61
#define __COMPILE_62
#define __COMPILE_63
#define __COMPILE_64
#define __COMPILE_65
#define __COMPILE_66
#define __COMPILE_67
#define __COMPILE_68
#define __COMPILE_69
#define __COMPILE_70
#define __COMPILE_71
#define __COMPILE_72
#define __COMPILE_73
#define __COMPILE_74
#define __COMPILE_75
#define __COMPILE_76
#define __COMPILE_77
#define __COMPILE_78
#define __COMPILE_79
#define __COMPILE_80
#define __COMPILE_81
#define __COMPILE_82
#define __COMPILE_83
#define __COMPILE_84
#define __COMPILE_85
#define __COMPILE_86
#define __COMPILE_87
#define __COMPILE_88
#define __COMPILE_89
#define __COMPILE_90
#define __COMPILE_91
#define __COMPILE_92
#define __COMPILE_93
#define __COMPILE_94
#define __COMPILE_95
#define __COMPILE_96
#define __COMPILE_97
#define __COMPILE_98
#define __COMPILE_99
#define __COMPILE_100
#define __COMPILE_101
#define __COMPILE_102
#define __COMPILE_103
#define __COMPILE_104
#define __COMPILE_105
#define __COMPILE_106
#define __COMPILE_107
#define __COMPILE_108
#define __COMPILE_109
#define __COMPILE_110
#define __COMPILE_111
#define __COMPILE_112
#define __COMPILE_113
#define __COMPILE_114
#define __COMPILE_115
#define __COMPILE_116
#define __COMPILE_117
#define __COMPILE_118
#define __COMPILE_119
#define __COMPILE_120
#define __COMPILE_121
#define __COMPILE_122
#define __COMPILE_123
#define __COMPILE_124
#define __COMPILE_125
#define __COMPILE_126
#define __COMPILE_127
#define __COMPILE_128
#define __COMPILE_129
#define __COMPILE_130
#define __COMPILE_131
#define __COMPILE_132
#define __COMPILE_133
#define __COMPILE_134
#define __COMPILE_135
#define __COMPILE_136
#define __COMPILE_137
#define __COMPILE_138
#define __COMPILE_139
#define __COMPILE_140
#define __COMPILE_141
#define __COMPILE_142
#define __COMPILE_143
#define __COMPILE_144
#define __COMPILE_145
#define __COMPILE_146
#define __COMPILE_147
#define __COMPILE_148
#define __COMPILE_149
#define __COMPILE_150
#define __COMPILE_151
#define __COMPILE_152
#define __COMPILE_153
#define __COMPILE_154
#define __COMPILE_155
#define __COMPILE_156
#define __COMPILE_157
#define __COMPILE_158
#define __COMPILE_159
#define __COMPILE_160
#define __COMPILE_161
#define __COMPILE_162
#define __COMPILE_163
#define __COMPILE_164
#define __COMPILE_165
#define __COMPILE_166
#define __COMPILE_167
#define __COMPILE_168
#define __COMPILE_169
#define __COMPILE_170
#define __COMPILE_171
#define __COMPILE_172
#define __COMPILE_173
#define __COMPILE_174
#define __COMPILE_175
#define __COMPILE_176
#define __COMPILE_177
#define __COMPILE_178
#define __COMPILE_179
#define __COMPILE_180
#define __COMPILE_181
#define __COMPILE_182
#define __COMPILE_183
#define __COMPILE_184
#define __COMPILE_185
#define __COMPILE_186
#define __COMPILE_187
#define __COMPILE_188
#define __COMPILE_189
#define __COMPILE_190
#define __COMPILE_191
#define __COMPILE_192
#define __COMPILE_193
#define __COMPILE_194
#define __COMPILE_195
#define __COMPILE_196
#define __COMPILE_197
#define __COMPILE_198
#define __COMPILE_199
#define __COMPILE_200
#define __COMPILE_201
#define __COMPILE_202
#define __COMPILE_203
#define __COMPILE_204
#define __COMPILE_205
#define __COMPILE_206
#define __COMPILE_207
#define __COMPILE_208
#define __COMPILE_209
#define __COMPILE_210
#define __COMPILE_211
#define __COMPILE_212
#define __COMPILE_213
#define __COMPILE_214
#define __COMPILE_215
#define __COMPILE_216
#define __COMPILE_217
#define __COMPILE_219
#define __COMPILE_220
#define __COMPILE_221
#define __COMPILE_222
#define __COMPILE_223
#define __COMPILE_224
#define __COMPILE_225
#define __COMPILE_226
#define __COMPILE_227
#define __COMPILE_231
#define __COMPILE_232
#define __COMPILE_233
#define __COMPILE_234
#define __COMPILE_235
#define __COMPILE_236
#define __COMPILE_237
#define __COMPILE_238
#define __COMPILE_239
#define __COMPILE_240
#define __COMPILE_242
#define __COMPILE_243
#define __COMPILE_244
#define __COMPILE_245
#define __COMPILE_246
#define __COMPILE_247
#define __COMPILE_248
#define __COMPILE_249
#define __COMPILE_250
#define __COMPILE_251
#define __COMPILE_252
#define __COMPILE_253
#define __COMPILE_254
#define __COMPILE_255
#define __COMPILE_256
#define __COMPILE_257
#define __COMPILE_258
#define __COMPILE_259
#define __COMPILE_260
#define __COMPILE_261
#define __COMPILE_262
#define __COMPILE_263
#define __COMPILE_264
#define __COMPILE_265
#define __COMPILE_266
#define __COMPILE_267
#define __COMPILE_268
#define __COMPILE_269
#define __COMPILE_270
#define __COMPILE_271
#define __COMPILE_272
#define __COMPILE_273
#define __COMPILE_274
#define __COMPILE_275
#define __COMPILE_276
#define __COMPILE_277
#define __COMPILE_278
#define __COMPILE_279
#define __COMPILE_280
#define __COMPILE_281
#define __COMPILE_282
#define __COMPILE_283
#define __COMPILE_284
#define __COMPILE_285
#define __COMPILE_286
#define __COMPILE_289
#define __COMPILE_290
#define __COMPILE_292
#define __COMPILE_293
#define __COMPILE_294
#define __COMPILE_295
#define __COMPILE_296
#define __COMPILE_297
#define __COMPILE_298
// compile_fin
int __get_mutant(); int __is_neg(const char *location,char *lid,int count, ...); int __abst_hole(); char *__stat_write_init(const char *func_name);void __write_stat(char *str,const char *var_name,void *var_addr,int size); void __stat_file_close(const char *func_name,char *str);long long __mutate(const long long,const char *,const char *); int __trident_choice(char* lid, char* typestr,int* rvals, char** rvals_ids, int rvals_size,int** lvals, char** lvals_ids, int lvals_size);int __trident_output(char* id, char* typestr, int value);float fabs_trident(float a);int __choose(const char *);void *__var_select(unsigned int var_count,void *vars[]);void *__var_select_2(unsigned int var_count,void *vars[]);long long __const_select(unsigned int const_count, ...);void* memset(void*, int, unsigned long); 
/*
 * make sure _GNU_SOURCE is defined
 */
#ifndef _GNU_SOURCE
#define _GNU_SOURCE
#endif

#include <sys/types.h>
#include <sys/stat.h>

#include <ctype.h>
#include <stdlib.h>
#include <string.h>
#include <fcntl.h> /* only the defines on windows */
#include <errno.h>
#include <time.h>

#include <stdio.h>

#include "base.h"
#include "log.h"
#include "buffer.h"

#include "plugin.h"

#include "inet_ntop_cache.h"

#include "sys-socket.h"
#include "sys-files.h"

#ifdef HAVE_SYSLOG_H
# include <syslog.h>
#endif

typedef struct {
	char key;
	enum {
		FORMAT_UNSET,
			FORMAT_UNSUPPORTED,
			FORMAT_PERCENT,
			FORMAT_REMOTE_HOST,
			FORMAT_REMOTE_IDENT,
			FORMAT_REMOTE_USER,
			FORMAT_TIMESTAMP,
			FORMAT_REQUEST_LINE,
			FORMAT_STATUS,
			FORMAT_BYTES_OUT_NO_HEADER,
			FORMAT_HEADER,

			FORMAT_REMOTE_ADDR,
			FORMAT_LOCAL_ADDR,
			FORMAT_COOKIE,
			FORMAT_TIME_USED_MS,
			FORMAT_ENV,
			FORMAT_FILENAME,
			FORMAT_REQUEST_PROTOCOL,
			FORMAT_REQUEST_METHOD,
			FORMAT_SERVER_PORT,
			FORMAT_QUERY_STRING,
			FORMAT_TIME_USED,
			FORMAT_URL,
			FORMAT_SERVER_NAME,
			FORMAT_HTTP_HOST,
			FORMAT_CONNECTION_STATUS,
			FORMAT_BYTES_IN,
			FORMAT_BYTES_OUT,

			FORMAT_RESPONSE_HEADER
	} type;
} format_mapping;

/**
 *
 *
 * "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\""
 *
 */

const format_mapping fmap[] =
{
	{ '%', FORMAT_PERCENT },
	{ 'h', FORMAT_REMOTE_HOST },
	{ 'l', FORMAT_REMOTE_IDENT },
	{ 'u', FORMAT_REMOTE_USER },
	{ 't', FORMAT_TIMESTAMP },
	{ 'r', FORMAT_REQUEST_LINE },
	{ 's', FORMAT_STATUS },
	{ 'b', FORMAT_BYTES_OUT_NO_HEADER },
	{ 'i', FORMAT_HEADER },

	{ 'a', FORMAT_REMOTE_ADDR },
	{ 'A', FORMAT_LOCAL_ADDR },
	{ 'B', FORMAT_BYTES_OUT_NO_HEADER },
	{ 'C', FORMAT_COOKIE },
	{ 'D', FORMAT_TIME_USED_MS },
	{ 'e', FORMAT_ENV },
	{ 'f', FORMAT_FILENAME },
	{ 'H', FORMAT_REQUEST_PROTOCOL },
	{ 'm', FORMAT_REQUEST_METHOD },
	{ 'n', FORMAT_UNSUPPORTED }, /* we have no notes */
	{ 'p', FORMAT_SERVER_PORT },
	{ 'P', FORMAT_UNSUPPORTED }, /* we are only one process */
	{ 'q', FORMAT_QUERY_STRING },
	{ 'T', FORMAT_TIME_USED },
	{ 'U', FORMAT_URL }, /* w/o querystring */
	{ 'v', FORMAT_SERVER_NAME },
	{ 'V', FORMAT_HTTP_HOST },
	{ 'X', FORMAT_CONNECTION_STATUS },
	{ 'I', FORMAT_BYTES_IN },
	{ 'O', FORMAT_BYTES_OUT },

	{ 'o', FORMAT_RESPONSE_HEADER },

	{ '\0', FORMAT_UNSET }
};


typedef struct {
	enum { FIELD_UNSET, FIELD_STRING, FIELD_FORMAT } type;

	buffer *string;
	int field;
} format_field;

typedef struct {
	format_field **ptr;

	size_t used;
	size_t size;
} format_fields;

typedef struct {
	buffer *access_logfile;
	buffer *format;
	unsigned short use_syslog;


	int    log_access_fd;
	time_t last_generated_accesslog_ts;
	time_t *last_generated_accesslog_ts_ptr;


	buffer *access_logbuffer;
	buffer *ts_accesslog_str;

	format_fields *parsed_format;
} plugin_config;

typedef struct {
	PLUGIN_DATA;

	plugin_config **config_storage;
	plugin_config conf;
} plugin_data;

INIT_FUNC(mod_accesslog_init) {
	plugin_data *p;

	UNUSED(srv);

	p = calloc(1, sizeof(*p));

	return p;
}

static void accesslog_append_escaped(buffer *dest, buffer *str) {
	/* replaces non-printable chars with \xHH where HH is the hex representation of the byte */
	/* exceptions: " => \", \ => \\, whitespace chars => \n \t etc. */
	//prophet generated patch
	{
	int __choose0 = __choose("__SWITCH0");
	if (__choose0 == 0)
	{}
	#ifdef __COMPILE_0
	else if (__choose0 == 1)
	{
	//AddInitKind
	memset(&str->ptr, 0, sizeof (*(&str->ptr)));
	}
	#endif
	#ifdef __COMPILE_1
	else if (__choose0 == 2)
	{
	//AddInitKind
	memset(&str->size, 0, sizeof (*(&str->size)));
	}
	#endif
	#ifdef __COMPILE_2
	else if (__choose0 == 3)
	{
	//AddInitKind
	memset(&str->used, 0, sizeof (*(&str->used)));
	}
	#endif
	#ifdef __COMPILE_3
	else if (__choose0 == 4)
	{
	//AddInitKind
	memset(str, 0, sizeof (*(str)));
	}
	#endif
	#ifdef __COMPILE_4
	else if (__choose0 == 5)
	{
	//AddInitKind
	memset(str->ptr, 0, sizeof (*(str->ptr)));
	}
	#endif
	#ifdef __COMPILE_5
	else if (__choose0 == 6)
	{
	//AddStmtAndReplaceAtomKind
	buffer_append_string_len((dest), " ", " " ? sizeof (" ") - 1 : 0);
	}
	#endif
	#ifdef __COMPILE_6
	else if (__choose0 == 7)
	{
	//AddStmtAndReplaceAtomKind
	buffer_append_string_len((dest), "-", "-" ? sizeof ("-") - 1 : 0);
	}
	#endif
	#ifdef __COMPILE_7
	else if (__choose0 == 8)
	{
	//AddStmtAndReplaceAtomKind
	buffer_append_string_len((dest), "\n", "\n" ? sizeof ("\n") - 1 : 0);
	}
	#endif
	#ifdef __COMPILE_8
	else if (__choose0 == 9)
	{
	//AddStmtAndReplaceAtomKind
	buffer_append_string_len((str), " ", " " ? sizeof (" ") - 1 : 0);
	}
	#endif
	#ifdef __COMPILE_9
	else if (__choose0 == 10)
	{
	//AddStmtAndReplaceAtomKind
	buffer_append_string_len((str), "-", "-" ? sizeof ("-") - 1 : 0);
	}
	#endif
	#ifdef __COMPILE_10
	else if (__choose0 == 11)
	{
	//AddStmtAndReplaceAtomKind
	buffer_append_string_len((str), "\n", "\n" ? sizeof ("\n") - 1 : 0);
	}
	#endif
	#ifdef __COMPILE_11
	else if (__choose0 == 12)
	{
	//AddStmtAndReplaceAtomKind
	buffer_copy_string_len((dest), "", "" ? sizeof ("") - 1 : 0);
	}
	#endif
	#ifdef __COMPILE_12
	else if (__choose0 == 13)
	{
	//AddStmtAndReplaceAtomKind
	buffer_copy_string_len((str), "", "" ? sizeof ("") - 1 : 0);
	}
	#endif
	#ifdef __COMPILE_13
	else if (__choose0 == 14)
	{
	//AddStmtAndReplaceAtomKind
	buffer_prepare_append((dest), str->used - 1);
	}
	#endif
	#ifdef __COMPILE_14
	else if (__choose0 == 15)
	{
	//AddStmtAndReplaceAtomKind
	buffer_prepare_append((str), str->used - 1);
	}
	#endif
	#ifdef __COMPILE_15
	else if (__choose0 == 16)
	{
	//AddStmtAndReplaceAtomKind
	buffer_prepare_append(dest && !(1 << 5), str->used - 1);
	}
	#endif
	#ifdef __COMPILE_16
	else if (__choose0 == 17)
	{
	//AddStmtAndReplaceAtomKind
	buffer_prepare_append(dest, (dest)->used - 1);
	}
	#endif
	#ifdef __COMPILE_17
	else if (__choose0 == 18)
	{
	//AddStmtAndReplaceAtomKind
	buffer_prepare_append(dest, (str)->used - 1);
	}
	#endif
	#ifdef __COMPILE_18
	else if (__choose0 == 19)
	{
	//AddStmtAndReplaceAtomKind
	buffer_prepare_append(dest, str && !(1 << 5)->used - 1);
	}
	#endif
	#ifdef __COMPILE_19
	else if (__choose0 == 20)
	{
	//AddStmtAndReplaceAtomKind
	buffer_reset((dest));
	}
	#endif
	#ifdef __COMPILE_20
	else if (__choose0 == 21)
	{
	//AddStmtAndReplaceAtomKind
	buffer_reset((str));
	}
	#endif
	#ifdef __COMPILE_21
	else if (__choose0 == 22)
	{
	//AddStmtKind
	buffer_prepare_append(dest, str->used - 1);
	}
	#endif
	#ifdef __COMPILE_22
	else if (__choose0 == 23)
	{
	//AddStmtKind
	exit(-1);
	}
	#endif
	#ifdef __COMPILE_23
	else if (__choose0 == 24)
	{
	//IfExitKind
	if (__is_neg("0-24", "L170", 5, &(dest), sizeof (dest), &(str),
				 sizeof (str), &(str->used), sizeof (str->used), &(str->ptr), sizeof (str->ptr), &(str->size),
				 sizeof (str->size)))
	    return;
	}
	#endif
	int __choose1 = __choose("__SWITCH1");
	if (__choose1 == 0)
	{
	buffer_prepare_append(dest, str->used - 1);
	
	}
	#ifdef __COMPILE_24
	else if (__choose1 == 1)
	{
	//GuardKind
	if (!__is_neg("1-1", "L170", 5, &(dest), sizeof (dest), &(str), sizeof (str), &(str->used), sizeof (str->used), &(str->ptr), sizeof (str->ptr), &(str->size), sizeof (str->size)))
	    buffer_prepare_append(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_25
	else if (__choose1 == 2)
	{
	//MSVExtFunctionReplaceKind
	SHA1(dest, str->used - 1, 0);
	
	}
	#endif
	#ifdef __COMPILE_26
	else if (__choose1 == 3)
	{
	//MSVExtFunctionReplaceKind
	SHA224(dest, str->used - 1, 0);
	
	}
	#endif
	#ifdef __COMPILE_27
	else if (__choose1 == 4)
	{
	//MSVExtFunctionReplaceKind
	SHA256(dest, str->used - 1, 0);
	
	}
	#endif
	#ifdef __COMPILE_28
	else if (__choose1 == 5)
	{
	//MSVExtFunctionReplaceKind
	SHA384(dest, str->used - 1, 0);
	
	}
	#endif
	#ifdef __COMPILE_29
	else if (__choose1 == 6)
	{
	//MSVExtFunctionReplaceKind
	SHA512(dest, str->used - 1, 0);
	
	}
	#endif
	#ifdef __COMPILE_30
	else if (__choose1 == 7)
	{
	//MSVExtFunctionReplaceKind
	X509_STORE_CTX_set_time(dest, str->used - 1, 0);
	
	}
	#endif
	#ifdef __COMPILE_31
	else if (__choose1 == 8)
	{
	//MSVExtFunctionReplaceKind
	X509_STORE_CTX_set_time(dest, str->used - 1, 1);
	
	}
	#endif
	#ifdef __COMPILE_32
	else if (__choose1 == 9)
	{
	//MSVExtFunctionReplaceKind
	X509_STORE_CTX_set_time(dest, str->used - 1, 10);
	
	}
	#endif
	#ifdef __COMPILE_33
	else if (__choose1 == 10)
	{
	//MSVExtFunctionReplaceKind
	X509_STORE_CTX_set_time(dest, str->used - 1, 16);
	
	}
	#endif
	#ifdef __COMPILE_34
	else if (__choose1 == 11)
	{
	//MSVExtFunctionReplaceKind
	X509_STORE_CTX_set_time(dest, str->used - 1, 2);
	
	}
	#endif
	#ifdef __COMPILE_35
	else if (__choose1 == 12)
	{
	//MSVExtFunctionReplaceKind
	X509_STORE_CTX_set_time(dest, str->used - 1, 3);
	
	}
	#endif
	#ifdef __COMPILE_36
	else if (__choose1 == 13)
	{
	//MSVExtFunctionReplaceKind
	X509_STORE_CTX_set_time(dest, str->used - 1, 4);
	
	}
	#endif
	#ifdef __COMPILE_37
	else if (__choose1 == 14)
	{
	//MSVExtFunctionReplaceKind
	X509_STORE_CTX_set_time(dest, str->used - 1, 5);
	
	}
	#endif
	#ifdef __COMPILE_38
	else if (__choose1 == 15)
	{
	//MSVExtFunctionReplaceKind
	X509_STORE_CTX_set_time(dest, str->used - 1, 9);
	
	}
	#endif
	#ifdef __COMPILE_39
	else if (__choose1 == 16)
	{
	//MSVExtFunctionReplaceKind
	_GLIB_CHECKED_ADD_U64(dest, str->used - 1, 0);
	
	}
	#endif
	#ifdef __COMPILE_40
	else if (__choose1 == 17)
	{
	//MSVExtFunctionReplaceKind
	_GLIB_CHECKED_ADD_U64(dest, str->used - 1, 1);
	
	}
	#endif
	#ifdef __COMPILE_41
	else if (__choose1 == 18)
	{
	//MSVExtFunctionReplaceKind
	_GLIB_CHECKED_ADD_U64(dest, str->used - 1, 10);
	
	}
	#endif
	#ifdef __COMPILE_42
	else if (__choose1 == 19)
	{
	//MSVExtFunctionReplaceKind
	_GLIB_CHECKED_ADD_U64(dest, str->used - 1, 16);
	
	}
	#endif
	#ifdef __COMPILE_43
	else if (__choose1 == 20)
	{
	//MSVExtFunctionReplaceKind
	_GLIB_CHECKED_ADD_U64(dest, str->used - 1, 2);
	
	}
	#endif
	#ifdef __COMPILE_44
	else if (__choose1 == 21)
	{
	//MSVExtFunctionReplaceKind
	_GLIB_CHECKED_ADD_U64(dest, str->used - 1, 3);
	
	}
	#endif
	#ifdef __COMPILE_45
	else if (__choose1 == 22)
	{
	//MSVExtFunctionReplaceKind
	_GLIB_CHECKED_ADD_U64(dest, str->used - 1, 4);
	
	}
	#endif
	#ifdef __COMPILE_46
	else if (__choose1 == 23)
	{
	//MSVExtFunctionReplaceKind
	_GLIB_CHECKED_ADD_U64(dest, str->used - 1, 5);
	
	}
	#endif
	#ifdef __COMPILE_47
	else if (__choose1 == 24)
	{
	//MSVExtFunctionReplaceKind
	_GLIB_CHECKED_ADD_U64(dest, str->used - 1, 9);
	
	}
	#endif
	#ifdef __COMPILE_48
	else if (__choose1 == 25)
	{
	//MSVExtFunctionReplaceKind
	_GLIB_CHECKED_MUL_U64(dest, str->used - 1, 0);
	
	}
	#endif
	#ifdef __COMPILE_49
	else if (__choose1 == 26)
	{
	//MSVExtFunctionReplaceKind
	_GLIB_CHECKED_MUL_U64(dest, str->used - 1, 1);
	
	}
	#endif
	#ifdef __COMPILE_50
	else if (__choose1 == 27)
	{
	//MSVExtFunctionReplaceKind
	_GLIB_CHECKED_MUL_U64(dest, str->used - 1, 10);
	
	}
	#endif
	#ifdef __COMPILE_51
	else if (__choose1 == 28)
	{
	//MSVExtFunctionReplaceKind
	_GLIB_CHECKED_MUL_U64(dest, str->used - 1, 16);
	
	}
	#endif
	#ifdef __COMPILE_52
	else if (__choose1 == 29)
	{
	//MSVExtFunctionReplaceKind
	_GLIB_CHECKED_MUL_U64(dest, str->used - 1, 2);
	
	}
	#endif
	#ifdef __COMPILE_53
	else if (__choose1 == 30)
	{
	//MSVExtFunctionReplaceKind
	_GLIB_CHECKED_MUL_U64(dest, str->used - 1, 3);
	
	}
	#endif
	#ifdef __COMPILE_54
	else if (__choose1 == 31)
	{
	//MSVExtFunctionReplaceKind
	_GLIB_CHECKED_MUL_U64(dest, str->used - 1, 4);
	
	}
	#endif
	#ifdef __COMPILE_55
	else if (__choose1 == 32)
	{
	//MSVExtFunctionReplaceKind
	_GLIB_CHECKED_MUL_U64(dest, str->used - 1, 5);
	
	}
	#endif
	#ifdef __COMPILE_56
	else if (__choose1 == 33)
	{
	//MSVExtFunctionReplaceKind
	_GLIB_CHECKED_MUL_U64(dest, str->used - 1, 9);
	
	}
	#endif
	#ifdef __COMPILE_57
	else if (__choose1 == 34)
	{
	//MSVExtFunctionReplaceKind
	fdevent_get_revents(dest, str->used - 1, 0);
	
	}
	#endif
	#ifdef __COMPILE_58
	else if (__choose1 == 35)
	{
	//MSVExtFunctionReplaceKind
	fmemopen(dest, str->used - 1, 0);
	
	}
	#endif
	#ifdef __COMPILE_59
	else if (__choose1 == 36)
	{
	//MSVExtFunctionReplaceKind
	g_bytes_new_from_bytes(dest, str->used - 1, 0);
	
	}
	#endif
	#ifdef __COMPILE_60
	else if (__choose1 == 37)
	{
	//MSVExtFunctionReplaceKind
	g_bytes_new_from_bytes(dest, str->used - 1, 1);
	
	}
	#endif
	#ifdef __COMPILE_61
	else if (__choose1 == 38)
	{
	//MSVExtFunctionReplaceKind
	g_bytes_new_from_bytes(dest, str->used - 1, 10);
	
	}
	#endif
	#ifdef __COMPILE_62
	else if (__choose1 == 39)
	{
	//MSVExtFunctionReplaceKind
	g_bytes_new_from_bytes(dest, str->used - 1, 16);
	
	}
	#endif
	#ifdef __COMPILE_63
	else if (__choose1 == 40)
	{
	//MSVExtFunctionReplaceKind
	g_bytes_new_from_bytes(dest, str->used - 1, 2);
	
	}
	#endif
	#ifdef __COMPILE_64
	else if (__choose1 == 41)
	{
	//MSVExtFunctionReplaceKind
	g_bytes_new_from_bytes(dest, str->used - 1, 3);
	
	}
	#endif
	#ifdef __COMPILE_65
	else if (__choose1 == 42)
	{
	//MSVExtFunctionReplaceKind
	g_bytes_new_from_bytes(dest, str->used - 1, 4);
	
	}
	#endif
	#ifdef __COMPILE_66
	else if (__choose1 == 43)
	{
	//MSVExtFunctionReplaceKind
	g_bytes_new_from_bytes(dest, str->used - 1, 5);
	
	}
	#endif
	#ifdef __COMPILE_67
	else if (__choose1 == 44)
	{
	//MSVExtFunctionReplaceKind
	g_bytes_new_from_bytes(dest, str->used - 1, 9);
	
	}
	#endif
	#ifdef __COMPILE_68
	else if (__choose1 == 45)
	{
	//MSVExtFunctionReplaceKind
	g_realloc_n(dest, str->used - 1, 0);
	
	}
	#endif
	#ifdef __COMPILE_69
	else if (__choose1 == 46)
	{
	//MSVExtFunctionReplaceKind
	g_realloc_n(dest, str->used - 1, 1);
	
	}
	#endif
	#ifdef __COMPILE_70
	else if (__choose1 == 47)
	{
	//MSVExtFunctionReplaceKind
	g_realloc_n(dest, str->used - 1, 10);
	
	}
	#endif
	#ifdef __COMPILE_71
	else if (__choose1 == 48)
	{
	//MSVExtFunctionReplaceKind
	g_realloc_n(dest, str->used - 1, 16);
	
	}
	#endif
	#ifdef __COMPILE_72
	else if (__choose1 == 49)
	{
	//MSVExtFunctionReplaceKind
	g_realloc_n(dest, str->used - 1, 2);
	
	}
	#endif
	#ifdef __COMPILE_73
	else if (__choose1 == 50)
	{
	//MSVExtFunctionReplaceKind
	g_realloc_n(dest, str->used - 1, 3);
	
	}
	#endif
	#ifdef __COMPILE_74
	else if (__choose1 == 51)
	{
	//MSVExtFunctionReplaceKind
	g_realloc_n(dest, str->used - 1, 4);
	
	}
	#endif
	#ifdef __COMPILE_75
	else if (__choose1 == 52)
	{
	//MSVExtFunctionReplaceKind
	g_realloc_n(dest, str->used - 1, 5);
	
	}
	#endif
	#ifdef __COMPILE_76
	else if (__choose1 == 53)
	{
	//MSVExtFunctionReplaceKind
	g_realloc_n(dest, str->used - 1, 9);
	
	}
	#endif
	#ifdef __COMPILE_77
	else if (__choose1 == 54)
	{
	//MSVExtFunctionReplaceKind
	g_string_overwrite(dest, str->used - 1, 0);
	
	}
	#endif
	#ifdef __COMPILE_78
	else if (__choose1 == 55)
	{
	//MSVExtFunctionReplaceKind
	g_test_trap_subprocess(dest, str->used - 1, 0);
	
	}
	#endif
	#ifdef __COMPILE_79
	else if (__choose1 == 56)
	{
	//MSVExtFunctionReplaceKind
	g_test_trap_subprocess(dest, str->used - 1, 1);
	
	}
	#endif
	#ifdef __COMPILE_80
	else if (__choose1 == 57)
	{
	//MSVExtFunctionReplaceKind
	g_test_trap_subprocess(dest, str->used - 1, 10);
	
	}
	#endif
	#ifdef __COMPILE_81
	else if (__choose1 == 58)
	{
	//MSVExtFunctionReplaceKind
	g_test_trap_subprocess(dest, str->used - 1, 16);
	
	}
	#endif
	#ifdef __COMPILE_82
	else if (__choose1 == 59)
	{
	//MSVExtFunctionReplaceKind
	g_test_trap_subprocess(dest, str->used - 1, 2);
	
	}
	#endif
	#ifdef __COMPILE_83
	else if (__choose1 == 60)
	{
	//MSVExtFunctionReplaceKind
	g_test_trap_subprocess(dest, str->used - 1, 3);
	
	}
	#endif
	#ifdef __COMPILE_84
	else if (__choose1 == 61)
	{
	//MSVExtFunctionReplaceKind
	g_test_trap_subprocess(dest, str->used - 1, 4);
	
	}
	#endif
	#ifdef __COMPILE_85
	else if (__choose1 == 62)
	{
	//MSVExtFunctionReplaceKind
	g_test_trap_subprocess(dest, str->used - 1, 5);
	
	}
	#endif
	#ifdef __COMPILE_86
	else if (__choose1 == 63)
	{
	//MSVExtFunctionReplaceKind
	g_test_trap_subprocess(dest, str->used - 1, 9);
	
	}
	#endif
	#ifdef __COMPILE_87
	else if (__choose1 == 64)
	{
	//MSVExtFunctionReplaceKind
	g_try_realloc_n(dest, str->used - 1, 0);
	
	}
	#endif
	#ifdef __COMPILE_88
	else if (__choose1 == 65)
	{
	//MSVExtFunctionReplaceKind
	g_try_realloc_n(dest, str->used - 1, 1);
	
	}
	#endif
	#ifdef __COMPILE_89
	else if (__choose1 == 66)
	{
	//MSVExtFunctionReplaceKind
	g_try_realloc_n(dest, str->used - 1, 10);
	
	}
	#endif
	#ifdef __COMPILE_90
	else if (__choose1 == 67)
	{
	//MSVExtFunctionReplaceKind
	g_try_realloc_n(dest, str->used - 1, 16);
	
	}
	#endif
	#ifdef __COMPILE_91
	else if (__choose1 == 68)
	{
	//MSVExtFunctionReplaceKind
	g_try_realloc_n(dest, str->used - 1, 2);
	
	}
	#endif
	#ifdef __COMPILE_92
	else if (__choose1 == 69)
	{
	//MSVExtFunctionReplaceKind
	g_try_realloc_n(dest, str->used - 1, 3);
	
	}
	#endif
	#ifdef __COMPILE_93
	else if (__choose1 == 70)
	{
	//MSVExtFunctionReplaceKind
	g_try_realloc_n(dest, str->used - 1, 4);
	
	}
	#endif
	#ifdef __COMPILE_94
	else if (__choose1 == 71)
	{
	//MSVExtFunctionReplaceKind
	g_try_realloc_n(dest, str->used - 1, 5);
	
	}
	#endif
	#ifdef __COMPILE_95
	else if (__choose1 == 72)
	{
	//MSVExtFunctionReplaceKind
	g_try_realloc_n(dest, str->used - 1, 9);
	
	}
	#endif
	#ifdef __COMPILE_96
	else if (__choose1 == 73)
	{
	//MSVExtFunctionReplaceKind
	madvise(dest, str->used - 1, 0);
	
	}
	#endif
	#ifdef __COMPILE_97
	else if (__choose1 == 74)
	{
	//MSVExtFunctionReplaceKind
	madvise(dest, str->used - 1, 1);
	
	}
	#endif
	#ifdef __COMPILE_98
	else if (__choose1 == 75)
	{
	//MSVExtFunctionReplaceKind
	madvise(dest, str->used - 1, 10);
	
	}
	#endif
	#ifdef __COMPILE_99
	else if (__choose1 == 76)
	{
	//MSVExtFunctionReplaceKind
	madvise(dest, str->used - 1, 16);
	
	}
	#endif
	#ifdef __COMPILE_100
	else if (__choose1 == 77)
	{
	//MSVExtFunctionReplaceKind
	madvise(dest, str->used - 1, 2);
	
	}
	#endif
	#ifdef __COMPILE_101
	else if (__choose1 == 78)
	{
	//MSVExtFunctionReplaceKind
	madvise(dest, str->used - 1, 3);
	
	}
	#endif
	#ifdef __COMPILE_102
	else if (__choose1 == 79)
	{
	//MSVExtFunctionReplaceKind
	madvise(dest, str->used - 1, 4);
	
	}
	#endif
	#ifdef __COMPILE_103
	else if (__choose1 == 80)
	{
	//MSVExtFunctionReplaceKind
	madvise(dest, str->used - 1, 5);
	
	}
	#endif
	#ifdef __COMPILE_104
	else if (__choose1 == 81)
	{
	//MSVExtFunctionReplaceKind
	madvise(dest, str->used - 1, 9);
	
	}
	#endif
	#ifdef __COMPILE_105
	else if (__choose1 == 82)
	{
	//MSVExtFunctionReplaceKind
	mincore(dest, str->used - 1, 0);
	
	}
	#endif
	#ifdef __COMPILE_106
	else if (__choose1 == 83)
	{
	//MSVExtFunctionReplaceKind
	mlock2(dest, str->used - 1, 0);
	
	}
	#endif
	#ifdef __COMPILE_107
	else if (__choose1 == 84)
	{
	//MSVExtFunctionReplaceKind
	mlock2(dest, str->used - 1, 1);
	
	}
	#endif
	#ifdef __COMPILE_108
	else if (__choose1 == 85)
	{
	//MSVExtFunctionReplaceKind
	mlock2(dest, str->used - 1, 10);
	
	}
	#endif
	#ifdef __COMPILE_109
	else if (__choose1 == 86)
	{
	//MSVExtFunctionReplaceKind
	mlock2(dest, str->used - 1, 16);
	
	}
	#endif
	#ifdef __COMPILE_110
	else if (__choose1 == 87)
	{
	//MSVExtFunctionReplaceKind
	mlock2(dest, str->used - 1, 2);
	
	}
	#endif
	#ifdef __COMPILE_111
	else if (__choose1 == 88)
	{
	//MSVExtFunctionReplaceKind
	mlock2(dest, str->used - 1, 3);
	
	}
	#endif
	#ifdef __COMPILE_112
	else if (__choose1 == 89)
	{
	//MSVExtFunctionReplaceKind
	mlock2(dest, str->used - 1, 4);
	
	}
	#endif
	#ifdef __COMPILE_113
	else if (__choose1 == 90)
	{
	//MSVExtFunctionReplaceKind
	mlock2(dest, str->used - 1, 5);
	
	}
	#endif
	#ifdef __COMPILE_114
	else if (__choose1 == 91)
	{
	//MSVExtFunctionReplaceKind
	mlock2(dest, str->used - 1, 9);
	
	}
	#endif
	#ifdef __COMPILE_115
	else if (__choose1 == 92)
	{
	//MSVExtFunctionReplaceKind
	mprotect(dest, str->used - 1, 0);
	
	}
	#endif
	#ifdef __COMPILE_116
	else if (__choose1 == 93)
	{
	//MSVExtFunctionReplaceKind
	mprotect(dest, str->used - 1, 1);
	
	}
	#endif
	#ifdef __COMPILE_117
	else if (__choose1 == 94)
	{
	//MSVExtFunctionReplaceKind
	mprotect(dest, str->used - 1, 10);
	
	}
	#endif
	#ifdef __COMPILE_118
	else if (__choose1 == 95)
	{
	//MSVExtFunctionReplaceKind
	mprotect(dest, str->used - 1, 16);
	
	}
	#endif
	#ifdef __COMPILE_119
	else if (__choose1 == 96)
	{
	//MSVExtFunctionReplaceKind
	mprotect(dest, str->used - 1, 2);
	
	}
	#endif
	#ifdef __COMPILE_120
	else if (__choose1 == 97)
	{
	//MSVExtFunctionReplaceKind
	mprotect(dest, str->used - 1, 3);
	
	}
	#endif
	#ifdef __COMPILE_121
	else if (__choose1 == 98)
	{
	//MSVExtFunctionReplaceKind
	mprotect(dest, str->used - 1, 4);
	
	}
	#endif
	#ifdef __COMPILE_122
	else if (__choose1 == 99)
	{
	//MSVExtFunctionReplaceKind
	mprotect(dest, str->used - 1, 5);
	
	}
	#endif
	#ifdef __COMPILE_123
	else if (__choose1 == 100)
	{
	//MSVExtFunctionReplaceKind
	mprotect(dest, str->used - 1, 9);
	
	}
	#endif
	#ifdef __COMPILE_124
	else if (__choose1 == 101)
	{
	//MSVExtFunctionReplaceKind
	msync(dest, str->used - 1, 0);
	
	}
	#endif
	#ifdef __COMPILE_125
	else if (__choose1 == 102)
	{
	//MSVExtFunctionReplaceKind
	msync(dest, str->used - 1, 1);
	
	}
	#endif
	#ifdef __COMPILE_126
	else if (__choose1 == 103)
	{
	//MSVExtFunctionReplaceKind
	msync(dest, str->used - 1, 10);
	
	}
	#endif
	#ifdef __COMPILE_127
	else if (__choose1 == 104)
	{
	//MSVExtFunctionReplaceKind
	msync(dest, str->used - 1, 16);
	
	}
	#endif
	#ifdef __COMPILE_128
	else if (__choose1 == 105)
	{
	//MSVExtFunctionReplaceKind
	msync(dest, str->used - 1, 2);
	
	}
	#endif
	#ifdef __COMPILE_129
	else if (__choose1 == 106)
	{
	//MSVExtFunctionReplaceKind
	msync(dest, str->used - 1, 3);
	
	}
	#endif
	#ifdef __COMPILE_130
	else if (__choose1 == 107)
	{
	//MSVExtFunctionReplaceKind
	msync(dest, str->used - 1, 4);
	
	}
	#endif
	#ifdef __COMPILE_131
	else if (__choose1 == 108)
	{
	//MSVExtFunctionReplaceKind
	msync(dest, str->used - 1, 5);
	
	}
	#endif
	#ifdef __COMPILE_132
	else if (__choose1 == 109)
	{
	//MSVExtFunctionReplaceKind
	msync(dest, str->used - 1, 9);
	
	}
	#endif
	#ifdef __COMPILE_133
	else if (__choose1 == 110)
	{
	//MSVExtFunctionReplaceKind
	poll(dest, str->used - 1, 0);
	
	}
	#endif
	#ifdef __COMPILE_134
	else if (__choose1 == 111)
	{
	//MSVExtFunctionReplaceKind
	poll(dest, str->used - 1, 1);
	
	}
	#endif
	#ifdef __COMPILE_135
	else if (__choose1 == 112)
	{
	//MSVExtFunctionReplaceKind
	poll(dest, str->used - 1, 10);
	
	}
	#endif
	#ifdef __COMPILE_136
	else if (__choose1 == 113)
	{
	//MSVExtFunctionReplaceKind
	poll(dest, str->used - 1, 16);
	
	}
	#endif
	#ifdef __COMPILE_137
	else if (__choose1 == 114)
	{
	//MSVExtFunctionReplaceKind
	poll(dest, str->used - 1, 2);
	
	}
	#endif
	#ifdef __COMPILE_138
	else if (__choose1 == 115)
	{
	//MSVExtFunctionReplaceKind
	poll(dest, str->used - 1, 3);
	
	}
	#endif
	#ifdef __COMPILE_139
	else if (__choose1 == 116)
	{
	//MSVExtFunctionReplaceKind
	poll(dest, str->used - 1, 4);
	
	}
	#endif
	#ifdef __COMPILE_140
	else if (__choose1 == 117)
	{
	//MSVExtFunctionReplaceKind
	poll(dest, str->used - 1, 5);
	
	}
	#endif
	#ifdef __COMPILE_141
	else if (__choose1 == 118)
	{
	//MSVExtFunctionReplaceKind
	poll(dest, str->used - 1, 9);
	
	}
	#endif
	#ifdef __COMPILE_142
	else if (__choose1 == 119)
	{
	//MSVExtFunctionReplaceKind
	posix_madvise(dest, str->used - 1, 0);
	
	}
	#endif
	#ifdef __COMPILE_143
	else if (__choose1 == 120)
	{
	//MSVExtFunctionReplaceKind
	posix_madvise(dest, str->used - 1, 1);
	
	}
	#endif
	#ifdef __COMPILE_144
	else if (__choose1 == 121)
	{
	//MSVExtFunctionReplaceKind
	posix_madvise(dest, str->used - 1, 10);
	
	}
	#endif
	#ifdef __COMPILE_145
	else if (__choose1 == 122)
	{
	//MSVExtFunctionReplaceKind
	posix_madvise(dest, str->used - 1, 16);
	
	}
	#endif
	#ifdef __COMPILE_146
	else if (__choose1 == 123)
	{
	//MSVExtFunctionReplaceKind
	posix_madvise(dest, str->used - 1, 2);
	
	}
	#endif
	#ifdef __COMPILE_147
	else if (__choose1 == 124)
	{
	//MSVExtFunctionReplaceKind
	posix_madvise(dest, str->used - 1, 3);
	
	}
	#endif
	#ifdef __COMPILE_148
	else if (__choose1 == 125)
	{
	//MSVExtFunctionReplaceKind
	posix_madvise(dest, str->used - 1, 4);
	
	}
	#endif
	#ifdef __COMPILE_149
	else if (__choose1 == 126)
	{
	//MSVExtFunctionReplaceKind
	posix_madvise(dest, str->used - 1, 5);
	
	}
	#endif
	#ifdef __COMPILE_150
	else if (__choose1 == 127)
	{
	//MSVExtFunctionReplaceKind
	posix_madvise(dest, str->used - 1, 9);
	
	}
	#endif
	#ifdef __COMPILE_151
	else if (__choose1 == 128)
	{
	//MSVExtFunctionReplaceKind
	posix_memalign(dest, str->used - 1, 0);
	
	}
	#endif
	#ifdef __COMPILE_152
	else if (__choose1 == 129)
	{
	//MSVExtFunctionReplaceKind
	posix_memalign(dest, str->used - 1, 1);
	
	}
	#endif
	#ifdef __COMPILE_153
	else if (__choose1 == 130)
	{
	//MSVExtFunctionReplaceKind
	posix_memalign(dest, str->used - 1, 10);
	
	}
	#endif
	#ifdef __COMPILE_154
	else if (__choose1 == 131)
	{
	//MSVExtFunctionReplaceKind
	posix_memalign(dest, str->used - 1, 16);
	
	}
	#endif
	#ifdef __COMPILE_155
	else if (__choose1 == 132)
	{
	//MSVExtFunctionReplaceKind
	posix_memalign(dest, str->used - 1, 2);
	
	}
	#endif
	#ifdef __COMPILE_156
	else if (__choose1 == 133)
	{
	//MSVExtFunctionReplaceKind
	posix_memalign(dest, str->used - 1, 3);
	
	}
	#endif
	#ifdef __COMPILE_157
	else if (__choose1 == 134)
	{
	//MSVExtFunctionReplaceKind
	posix_memalign(dest, str->used - 1, 4);
	
	}
	#endif
	#ifdef __COMPILE_158
	else if (__choose1 == 135)
	{
	//MSVExtFunctionReplaceKind
	posix_memalign(dest, str->used - 1, 5);
	
	}
	#endif
	#ifdef __COMPILE_159
	else if (__choose1 == 136)
	{
	//MSVExtFunctionReplaceKind
	posix_memalign(dest, str->used - 1, 9);
	
	}
	#endif
	#ifdef __COMPILE_160
	else if (__choose1 == 137)
	{
	//MSVExtFunctionReplaceKind
	pthread_attr_getaffinity_np(dest, str->used - 1, 0);
	
	}
	#endif
	#ifdef __COMPILE_161
	else if (__choose1 == 138)
	{
	//MSVExtFunctionReplaceKind
	pthread_attr_setaffinity_np(dest, str->used - 1, 0);
	
	}
	#endif
	#ifdef __COMPILE_162
	else if (__choose1 == 139)
	{
	//MSVExtFunctionReplaceKind
	reallocarray(dest, str->used - 1, 0);
	
	}
	#endif
	#ifdef __COMPILE_163
	else if (__choose1 == 140)
	{
	//MSVExtFunctionReplaceKind
	reallocarray(dest, str->used - 1, 1);
	
	}
	#endif
	#ifdef __COMPILE_164
	else if (__choose1 == 141)
	{
	//MSVExtFunctionReplaceKind
	reallocarray(dest, str->used - 1, 10);
	
	}
	#endif
	#ifdef __COMPILE_165
	else if (__choose1 == 142)
	{
	//MSVExtFunctionReplaceKind
	reallocarray(dest, str->used - 1, 16);
	
	}
	#endif
	#ifdef __COMPILE_166
	else if (__choose1 == 143)
	{
	//MSVExtFunctionReplaceKind
	reallocarray(dest, str->used - 1, 2);
	
	}
	#endif
	#ifdef __COMPILE_167
	else if (__choose1 == 144)
	{
	//MSVExtFunctionReplaceKind
	reallocarray(dest, str->used - 1, 3);
	
	}
	#endif
	#ifdef __COMPILE_168
	else if (__choose1 == 145)
	{
	//MSVExtFunctionReplaceKind
	reallocarray(dest, str->used - 1, 4);
	
	}
	#endif
	#ifdef __COMPILE_169
	else if (__choose1 == 146)
	{
	//MSVExtFunctionReplaceKind
	reallocarray(dest, str->used - 1, 5);
	
	}
	#endif
	#ifdef __COMPILE_170
	else if (__choose1 == 147)
	{
	//MSVExtFunctionReplaceKind
	reallocarray(dest, str->used - 1, 9);
	
	}
	#endif
	#ifdef __COMPILE_171
	else if (__choose1 == 148)
	{
	//MSVExtRemoveStmtKind
	{
	}
	
	}
	#endif
	#ifdef __COMPILE_172
	else if (__choose1 == 149)
	{
	//ReplaceFunctionKind
	ASN1_INTEGER_set_uint64(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_173
	else if (__choose1 == 150)
	{
	//ReplaceFunctionKind
	ASN1_PCTX_set_cert_flags(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_174
	else if (__choose1 == 151)
	{
	//ReplaceFunctionKind
	ASN1_PCTX_set_flags(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_175
	else if (__choose1 == 152)
	{
	//ReplaceFunctionKind
	ASN1_PCTX_set_nm_flags(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_176
	else if (__choose1 == 153)
	{
	//ReplaceFunctionKind
	ASN1_PCTX_set_oid_flags(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_177
	else if (__choose1 == 154)
	{
	//ReplaceFunctionKind
	ASN1_PCTX_set_str_flags(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_178
	else if (__choose1 == 155)
	{
	//ReplaceFunctionKind
	BN_BLINDING_set_flags(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_179
	else if (__choose1 == 156)
	{
	//ReplaceFunctionKind
	BN_abs_is_word(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_180
	else if (__choose1 == 157)
	{
	//ReplaceFunctionKind
	BN_add_word(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_181
	else if (__choose1 == 158)
	{
	//ReplaceFunctionKind
	BN_div_word(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_182
	else if (__choose1 == 159)
	{
	//ReplaceFunctionKind
	BN_is_word(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_183
	else if (__choose1 == 160)
	{
	//ReplaceFunctionKind
	BN_mod_word(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_184
	else if (__choose1 == 161)
	{
	//ReplaceFunctionKind
	BN_mul_word(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_185
	else if (__choose1 == 162)
	{
	//ReplaceFunctionKind
	BN_set_word(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_186
	else if (__choose1 == 163)
	{
	//ReplaceFunctionKind
	BN_sub_word(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_187
	else if (__choose1 == 164)
	{
	//ReplaceFunctionKind
	BUF_MEM_grow(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_188
	else if (__choose1 == 165)
	{
	//ReplaceFunctionKind
	BUF_MEM_grow_clean(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_189
	else if (__choose1 == 166)
	{
	//ReplaceFunctionKind
	CT_POLICY_EVAL_CTX_set_time(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_190
	else if (__choose1 == 167)
	{
	//ReplaceFunctionKind
	EC_get_builtin_curves(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_191
	else if (__choose1 == 168)
	{
	//ReplaceFunctionKind
	EVP_CIPHER_meth_set_flags(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_192
	else if (__choose1 == 169)
	{
	//ReplaceFunctionKind
	EVP_MD_meth_set_flags(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_193
	else if (__choose1 == 170)
	{
	//ReplaceFunctionKind
	HMAC_CTX_set_flags(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_194
	else if (__choose1 == 171)
	{
	//ReplaceFunctionKind
	OPENSSL_LH_set_down_load(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_195
	else if (__choose1 == 172)
	{
	//ReplaceFunctionKind
	OPENSSL_cleanse(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_196
	else if (__choose1 == 173)
	{
	//ReplaceFunctionKind
	OPENSSL_strnlen(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_197
	else if (__choose1 == 174)
	{
	//ReplaceFunctionKind
	SCT_set_timestamp(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_198
	else if (__choose1 == 175)
	{
	//ReplaceFunctionKind
	SSL_CTX_clear_options(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_199
	else if (__choose1 == 176)
	{
	//ReplaceFunctionKind
	SSL_CTX_dane_clear_flags(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_200
	else if (__choose1 == 177)
	{
	//ReplaceFunctionKind
	SSL_CTX_dane_set_flags(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_201
	else if (__choose1 == 178)
	{
	//ReplaceFunctionKind
	SSL_CTX_set_block_padding(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_202
	else if (__choose1 == 179)
	{
	//ReplaceFunctionKind
	SSL_CTX_set_default_read_buffer_len(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_203
	else if (__choose1 == 180)
	{
	//ReplaceFunctionKind
	SSL_CTX_set_num_tickets(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_204
	else if (__choose1 == 181)
	{
	//ReplaceFunctionKind
	SSL_CTX_set_options(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_205
	else if (__choose1 == 182)
	{
	//ReplaceFunctionKind
	SSL_clear_options(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_206
	else if (__choose1 == 183)
	{
	//ReplaceFunctionKind
	SSL_dane_clear_flags(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_207
	else if (__choose1 == 184)
	{
	//ReplaceFunctionKind
	SSL_dane_set_flags(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_208
	else if (__choose1 == 185)
	{
	//ReplaceFunctionKind
	SSL_set_block_padding(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_209
	else if (__choose1 == 186)
	{
	//ReplaceFunctionKind
	SSL_set_default_read_buffer_len(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_210
	else if (__choose1 == 187)
	{
	//ReplaceFunctionKind
	SSL_set_num_tickets(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_211
	else if (__choose1 == 188)
	{
	//ReplaceFunctionKind
	SSL_set_options(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_212
	else if (__choose1 == 189)
	{
	//ReplaceFunctionKind
	VALGRIND_PRINTF(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_213
	else if (__choose1 == 190)
	{
	//ReplaceFunctionKind
	VALGRIND_PRINTF_BACKTRACE(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_214
	else if (__choose1 == 191)
	{
	//ReplaceFunctionKind
	X509_STORE_CTX_set_flags(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_215
	else if (__choose1 == 192)
	{
	//ReplaceFunctionKind
	X509_STORE_set_flags(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_216
	else if (__choose1 == 193)
	{
	//ReplaceFunctionKind
	X509_VERIFY_PARAM_clear_flags(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_217
	else if (__choose1 == 194)
	{
	//ReplaceFunctionKind
	X509_VERIFY_PARAM_set_flags(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_218
	else if (__choose1 == 195)
	{
	//ReplaceFunctionKind
	__builtin_va_start(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_219
	else if (__choose1 == 196)
	{
	//ReplaceFunctionKind
	bitset_clear_bit(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_220
	else if (__choose1 == 197)
	{
	//ReplaceFunctionKind
	bitset_set_bit(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_221
	else if (__choose1 == 198)
	{
	//ReplaceFunctionKind
	bitset_test_bit(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_222
	else if (__choose1 == 199)
	{
	//ReplaceFunctionKind
	buffer_append_long_hex(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_223
	else if (__choose1 == 200)
	{
	//ReplaceFunctionKind
	buffer_prepare_copy(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_224
	else if (__choose1 == 201)
	{
	//ReplaceFunctionKind
	bzero(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_225
	else if (__choose1 == 202)
	{
	//ReplaceFunctionKind
	explicit_bzero(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_226
	else if (__choose1 == 203)
	{
	//ReplaceFunctionKind
	g_async_queue_timeout_pop(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_227
	else if (__choose1 == 204)
	{
	//ReplaceFunctionKind
	g_async_queue_timeout_pop_unlocked(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_228
	else if (__choose1 == 205)
	{
	//ReplaceFunctionKind
	g_atomic_pointer_and(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_229
	else if (__choose1 == 206)
	{
	//ReplaceFunctionKind
	g_atomic_pointer_or(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_230
	else if (__choose1 == 207)
	{
	//ReplaceFunctionKind
	g_atomic_pointer_xor(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_231
	else if (__choose1 == 208)
	{
	//ReplaceFunctionKind
	g_base64_encode(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_232
	else if (__choose1 == 209)
	{
	//ReplaceFunctionKind
	g_build_filename(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_233
	else if (__choose1 == 210)
	{
	//ReplaceFunctionKind
	g_byte_array_new_take(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_234
	else if (__choose1 == 211)
	{
	//ReplaceFunctionKind
	g_bytes_new(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_235
	else if (__choose1 == 212)
	{
	//ReplaceFunctionKind
	g_bytes_new_static(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_236
	else if (__choose1 == 213)
	{
	//ReplaceFunctionKind
	g_bytes_new_take(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_237
	else if (__choose1 == 214)
	{
	//ReplaceFunctionKind
	g_hook_destroy(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_238
	else if (__choose1 == 215)
	{
	//ReplaceFunctionKind
	g_hook_get(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_239
	else if (__choose1 == 216)
	{
	//ReplaceFunctionKind
	g_io_channel_set_buffer_size(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_240
	else if (__choose1 == 217)
	{
	//ReplaceFunctionKind
	g_markup_printf_escaped(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_241
	else if (__choose1 == 218)
	{
	//ReplaceFunctionKind
	g_once_init_leave(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_242
	else if (__choose1 == 219)
	{
	//ReplaceFunctionKind
	g_print(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_243
	else if (__choose1 == 220)
	{
	//ReplaceFunctionKind
	g_printerr(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_244
	else if (__choose1 == 221)
	{
	//ReplaceFunctionKind
	g_realloc(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_245
	else if (__choose1 == 222)
	{
	//ReplaceFunctionKind
	g_relation_exists(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_246
	else if (__choose1 == 223)
	{
	//ReplaceFunctionKind
	g_relation_insert(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_247
	else if (__choose1 == 224)
	{
	//ReplaceFunctionKind
	g_strconcat(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_248
	else if (__choose1 == 225)
	{
	//ReplaceFunctionKind
	g_strdup_printf(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_249
	else if (__choose1 == 226)
	{
	//ReplaceFunctionKind
	g_string_set_size(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_250
	else if (__choose1 == 227)
	{
	//ReplaceFunctionKind
	g_string_truncate(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_251
	else if (__choose1 == 228)
	{
	//ReplaceFunctionKind
	g_strjoin(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_252
	else if (__choose1 == 229)
	{
	//ReplaceFunctionKind
	g_strndup(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_253
	else if (__choose1 == 230)
	{
	//ReplaceFunctionKind
	g_test_message(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_254
	else if (__choose1 == 231)
	{
	//ReplaceFunctionKind
	g_try_realloc(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_255
	else if (__choose1 == 232)
	{
	//ReplaceFunctionKind
	g_unicode_canonical_ordering(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_256
	else if (__choose1 == 233)
	{
	//ReplaceFunctionKind
	g_variant_get_child_value(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_257
	else if (__choose1 == 234)
	{
	//ReplaceFunctionKind
	g_variant_new(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_258
	else if (__choose1 == 235)
	{
	//ReplaceFunctionKind
	g_variant_new_parsed(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_259
	else if (__choose1 == 236)
	{
	//ReplaceFunctionKind
	g_variant_new_printf(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_260
	else if (__choose1 == 237)
	{
	//ReplaceFunctionKind
	g_variant_new_tuple(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_261
	else if (__choose1 == 238)
	{
	//ReplaceFunctionKind
	getcwd(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_262
	else if (__choose1 == 239)
	{
	//ReplaceFunctionKind
	getdomainname(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_263
	else if (__choose1 == 240)
	{
	//ReplaceFunctionKind
	getentropy(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_264
	else if (__choose1 == 241)
	{
	//ReplaceFunctionKind
	gethostname(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_265
	else if (__choose1 == 242)
	{
	//ReplaceFunctionKind
	getlogin_r(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_266
	else if (__choose1 == 243)
	{
	//ReplaceFunctionKind
	lh_OPENSSL_CSTRING_set_down_load(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_267
	else if (__choose1 == 244)
	{
	//ReplaceFunctionKind
	lh_OPENSSL_STRING_set_down_load(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_268
	else if (__choose1 == 245)
	{
	//ReplaceFunctionKind
	log_trace(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_269
	else if (__choose1 == 246)
	{
	//ReplaceFunctionKind
	mblen(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_270
	else if (__choose1 == 247)
	{
	//ReplaceFunctionKind
	memfrob(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_271
	else if (__choose1 == 248)
	{
	//ReplaceFunctionKind
	mlock(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_272
	else if (__choose1 == 249)
	{
	//ReplaceFunctionKind
	munlock(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_273
	else if (__choose1 == 250)
	{
	//ReplaceFunctionKind
	munmap(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_274
	else if (__choose1 == 251)
	{
	//ReplaceFunctionKind
	printf(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_275
	else if (__choose1 == 252)
	{
	//ReplaceFunctionKind
	pthread_attr_setguardsize(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_276
	else if (__choose1 == 253)
	{
	//ReplaceFunctionKind
	pthread_attr_setstacksize(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_277
	else if (__choose1 == 254)
	{
	//ReplaceFunctionKind
	realloc(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_278
	else if (__choose1 == 255)
	{
	//ReplaceFunctionKind
	setdomainname(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_279
	else if (__choose1 == 256)
	{
	//ReplaceFunctionKind
	sethostname(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_280
	else if (__choose1 == 257)
	{
	//ReplaceFunctionKind
	strndup(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_281
	else if (__choose1 == 258)
	{
	//ReplaceFunctionKind
	strnlen(dest, str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_282
	else if (__choose1 == 259)
	{
	//ReplaceKind
	buffer_prepare_append((&dest), str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_283
	else if (__choose1 == 260)
	{
	//ReplaceKind
	buffer_prepare_append((&str), str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_284
	else if (__choose1 == 261)
	{
	//ReplaceKind
	buffer_prepare_append((dest), str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_285
	else if (__choose1 == 262)
	{
	//ReplaceKind
	buffer_prepare_append((str), str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_286
	else if (__choose1 == 263)
	{
	//ReplaceKind
	buffer_prepare_append(dest && !(1 << 5), str->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_287
	else if (__choose1 == 264)
	{
	//ReplaceKind
	buffer_prepare_append(dest, (&dest)->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_288
	else if (__choose1 == 265)
	{
	//ReplaceKind
	buffer_prepare_append(dest, (&str)->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_289
	else if (__choose1 == 266)
	{
	//ReplaceKind
	buffer_prepare_append(dest, (dest)->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_290
	else if (__choose1 == 267)
	{
	//ReplaceKind
	buffer_prepare_append(dest, (str)->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_291
	else if (__choose1 == 268)
	{
	//ReplaceKind
	buffer_prepare_append(dest, str && !(1 << 5)->used - 1);
	
	}
	#endif
	#ifdef __COMPILE_292
	else if (__choose1 == 269)
	{
	//ReplaceKind
	buffer_prepare_append(dest, str->used - (0));
	
	}
	#endif
	#ifdef __COMPILE_293
	else if (__choose1 == 270)
	{
	//ReplaceKind
	buffer_prepare_append(dest, str->used - (dest != 0));
	
	}
	#endif
	#ifdef __COMPILE_294
	else if (__choose1 == 271)
	{
	//ReplaceKind
	buffer_prepare_append(dest, str->used - (dest != str));
	
	}
	#endif
	#ifdef __COMPILE_295
	else if (__choose1 == 272)
	{
	//ReplaceKind
	buffer_prepare_append(dest, str->used - (dest == 0));
	
	}
	#endif
	#ifdef __COMPILE_296
	else if (__choose1 == 273)
	{
	//ReplaceKind
	buffer_prepare_append(dest, str->used - (dest == str));
	
	}
	#endif
	#ifdef __COMPILE_297
	else if (__choose1 == 274)
	{
	//ReplaceKind
	buffer_prepare_append(dest, str->used - (str != 0));
	
	}
	#endif
	#ifdef __COMPILE_298
	else if (__choose1 == 275)
	{
	//ReplaceKind
	buffer_prepare_append(dest, str->used - (str == 0));
	
	}
	#endif
	}

	for (unsigned int i = 0; i < str->used - 1; i++) {
		if (str->ptr[i] >= ' ' && str->ptr[i] <= '~') {
			/* printable chars */
			buffer_append_string_len(dest, &str->ptr[i], 1);
		} else switch (str->ptr[i]) {
		case '"':
			BUFFER_APPEND_STRING_CONST(dest, "\\\"");
			break;
		case '\\':
			BUFFER_APPEND_STRING_CONST(dest, "\\\\");
			break;
		case '\b':
			BUFFER_APPEND_STRING_CONST(dest, "\\b");
			break;
		case '\n':
			BUFFER_APPEND_STRING_CONST(dest, "\\n");
			break;
		case '\r':
			BUFFER_APPEND_STRING_CONST(dest, "\\r");
			break;
		case '\t':
			BUFFER_APPEND_STRING_CONST(dest, "\\t");
			break;
		case '\v':
			BUFFER_APPEND_STRING_CONST(dest, "\\v");
			break;
		default: {
				/* non printable char => \xHH */
				char hh[5] = {'\\','x',0,0,0};
				char h = str->ptr[i] / 16;
				hh[2] = (h > 9) ? (h - 10 + 'A') : (h + '0');
				h = str->ptr[i] % 16;
				hh[3] = (h > 9) ? (h - 10 + 'A') : (h + '0');
				buffer_append_string_len(dest, &hh[0], 4);
			}
			break;
		}
	}
}

static int accesslog_parse_format(server *srv, format_fields *fields, buffer *format) {
	size_t i, j, k = 0, start = 0;

	for (i = 0; i < format->used - 1; i++) {

		switch(format->ptr[i]) {
		case '%':
			if (start != i) {
				/* copy the string */
				if (fields->size == 0) {
					fields->size = 16;
					fields->used = 0;
					fields->ptr = malloc(fields->size * sizeof(format_field * ));
				} else if (fields->used == fields->size) {
					fields->size += 16;
					fields->ptr = realloc(fields->ptr, fields->size * sizeof(format_field * ));
				}

				fields->ptr[fields->used] = malloc(sizeof(format_field));
				fields->ptr[fields->used]->type = FIELD_STRING;
				fields->ptr[fields->used]->string = buffer_init();

				buffer_copy_string_len(fields->ptr[fields->used]->string, format->ptr + start, i - start);

				fields->used++;
			}


			/* we need a new field */

			if (fields->size == 0) {
				fields->size = 16;
				fields->used = 0;
				fields->ptr = malloc(fields->size * sizeof(format_field * ));
			} else if (fields->used == fields->size) {
				fields->size += 16;
				fields->ptr = realloc(fields->ptr, fields->size * sizeof(format_field * ));
			}

			/* search for the terminating command */
			switch (format->ptr[i+1]) {
			case '>':
			case '<':
				/* only for s */

				for (j = 0; fmap[j].key != '\0'; j++) {
					if (fmap[j].key != format->ptr[i+2]) continue;

					/* found key */

					fields->ptr[fields->used] = malloc(sizeof(format_field));
					fields->ptr[fields->used]->type = FIELD_FORMAT;
					fields->ptr[fields->used]->field = fmap[j].type;
					fields->ptr[fields->used]->string = NULL;

					fields->used++;

					break;
				}

				if (fmap[j].key == '\0') {
					log_error_write(srv, __FILE__, __LINE__, "ss", "config: ", "failed");
					return -1;
				}

				start = i + 3;

				break;
			case '{':
				/* go forward to } */

				for (k = i+2; k < format->used - 1; k++) {
					if (format->ptr[k] == '}') break;
				}

				if (k == format->used - 1) {
					log_error_write(srv, __FILE__, __LINE__, "ss", "config: ", "failed");
					return -1;
				}
				if (format->ptr[k+1] == '\0') {
					log_error_write(srv, __FILE__, __LINE__, "ss", "config: ", "failed");
					return -1;
				}

				for (j = 0; fmap[j].key != '\0'; j++) {
					if (fmap[j].key != format->ptr[k+1]) continue;

					/* found key */

					fields->ptr[fields->used] = malloc(sizeof(format_field));
					fields->ptr[fields->used]->type = FIELD_FORMAT;
					fields->ptr[fields->used]->field = fmap[j].type;
					fields->ptr[fields->used]->string = buffer_init();

					buffer_copy_string_len(fields->ptr[fields->used]->string, format->ptr + i + 2, k - (i + 2));

					fields->used++;

					break;
				}

				if (fmap[j].key == '\0') {
					log_error_write(srv, __FILE__, __LINE__, "ss", "config: ", "failed");
					return -1;
				}

				start = k + 2;

				break;
			default:
				for (j = 0; fmap[j].key != '\0'; j++) {
					if (fmap[j].key != format->ptr[i+1]) continue;

					/* found key */

					fields->ptr[fields->used] = malloc(sizeof(format_field));
					fields->ptr[fields->used]->type = FIELD_FORMAT;
					fields->ptr[fields->used]->field = fmap[j].type;
					fields->ptr[fields->used]->string = NULL;

					fields->used++;

					break;
				}

				if (fmap[j].key == '\0') {
					log_error_write(srv, __FILE__, __LINE__, "ss", "config: ", "failed");
					return -1;
				}

				start = i + 2;

				break;
			}

			break;
		}
	}

	if (start < i) {
		/* copy the string */
		if (fields->size == 0) {
			fields->size = 16;
			fields->used = 0;
			fields->ptr = malloc(fields->size * sizeof(format_field * ));
		} else if (fields->used == fields->size) {
			fields->size += 16;
			fields->ptr = realloc(fields->ptr, fields->size * sizeof(format_field * ));
		}

		fields->ptr[fields->used] = malloc(sizeof(format_field));
		fields->ptr[fields->used]->type = FIELD_STRING;
		fields->ptr[fields->used]->string = buffer_init();

		buffer_copy_string_len(fields->ptr[fields->used]->string, format->ptr + start, i - start);

		fields->used++;
	}

	return 0;
}

FREE_FUNC(mod_accesslog_free) {
	plugin_data *p = p_d;
	size_t i;

	if (!p) return HANDLER_GO_ON;

	if (p->config_storage) {

		for (i = 0; i < srv->config_context->used; i++) {
			plugin_config *s = p->config_storage[i];

			if (!s) continue;

			if (s->access_logbuffer->used) {
				if (s->use_syslog) {
# ifdef HAVE_SYSLOG_H
					if (s->access_logbuffer->used > 2) {
						syslog(LOG_INFO, "%*s", (int) s->access_logbuffer->used - 2, s->access_logbuffer->ptr);
					}
# endif
				} else if (s->log_access_fd != -1) {
					write(s->log_access_fd, s->access_logbuffer->ptr, s->access_logbuffer->used - 1);
				}
			}

			if (s->log_access_fd != -1) close(s->log_access_fd);

			buffer_free(s->ts_accesslog_str);
			buffer_free(s->access_logbuffer);
			buffer_free(s->format);
			buffer_free(s->access_logfile);

			if (s->parsed_format) {
				size_t j;
				for (j = 0; j < s->parsed_format->used; j++) {
					if (s->parsed_format->ptr[j]->string) buffer_free(s->parsed_format->ptr[j]->string);
					free(s->parsed_format->ptr[j]);
				}
				free(s->parsed_format->ptr);
				free(s->parsed_format);
			}

			free(s);
		}

		free(p->config_storage);
	}

	free(p);

	return HANDLER_GO_ON;
}

SETDEFAULTS_FUNC(log_access_open) {
	plugin_data *p = p_d;
	size_t i = 0;

	config_values_t cv[] = {
		{ "accesslog.filename",             NULL, T_CONFIG_STRING, T_CONFIG_SCOPE_CONNECTION },
		{ "accesslog.use-syslog",           NULL, T_CONFIG_BOOLEAN, T_CONFIG_SCOPE_CONNECTION },
		{ "accesslog.format",               NULL, T_CONFIG_STRING, T_CONFIG_SCOPE_CONNECTION },
		{ NULL,                             NULL, T_CONFIG_UNSET, T_CONFIG_SCOPE_UNSET }
	};

	if (!p) return HANDLER_ERROR;

	p->config_storage = calloc(1, srv->config_context->used * sizeof(specific_config *));

	for (i = 0; i < srv->config_context->used; i++) {
		plugin_config *s;

		s = calloc(1, sizeof(plugin_config));
		s->access_logfile = buffer_init();
		s->format = buffer_init();
		s->access_logbuffer = buffer_init();
		s->ts_accesslog_str = buffer_init();
		s->log_access_fd = -1;
		s->last_generated_accesslog_ts = 0;
		s->last_generated_accesslog_ts_ptr = &(s->last_generated_accesslog_ts);


		cv[0].destination = s->access_logfile;
		cv[1].destination = &(s->use_syslog);
		cv[2].destination = s->format;

		p->config_storage[i] = s;

		if (0 != config_insert_values_global(srv, ((data_config *)srv->config_context->data[i])->value, cv)) {
			return HANDLER_ERROR;
		}

		if (i == 0 && buffer_is_empty(s->format)) {
			/* set a default logfile string */

			buffer_copy_string_len(s->format, CONST_STR_LEN("%h %V %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\""));
		}

		/* parse */

		if (s->format->used) {
			s->parsed_format = calloc(1, sizeof(*(s->parsed_format)));

			if (-1 == accesslog_parse_format(srv, s->parsed_format, s->format)) {

				log_error_write(srv, __FILE__, __LINE__, "sb",
						"parsing accesslog-definition failed:", s->format);

				return HANDLER_ERROR;
			}
#if 0
			/* debugging */
			for (j = 0; j < s->parsed_format->used; j++) {
				switch (s->parsed_format->ptr[j]->type) {
				case FIELD_FORMAT:
					log_error_write(srv, __FILE__, __LINE__, "ssds",
							"config:", "format", s->parsed_format->ptr[j]->field,
							s->parsed_format->ptr[j]->string ?
							s->parsed_format->ptr[j]->string->ptr : "" );
					break;
				case FIELD_STRING:
					log_error_write(srv, __FILE__, __LINE__, "ssbs", "config:", "string '", s->parsed_format->ptr[j]->string, "'");
					break;
				default:
					break;
				}
			}
#endif
		}

		if (s->use_syslog) {
			/* ignore the next checks */
			continue;
		}

		if (buffer_is_empty(s->access_logfile)) continue;

		if (s->access_logfile->ptr[0] == '|') {
#ifdef HAVE_FORK
			/* create write pipe and spawn process */

			int to_log_fds[2];
			pid_t pid;

			if (pipe(to_log_fds)) {
				log_error_write(srv, __FILE__, __LINE__, "ss", "pipe failed: ", strerror(errno));
				return HANDLER_ERROR;
			}

			/* fork, execve */
			switch (pid = fork()) {
			case 0:
				/* child */

				close(STDIN_FILENO);
				dup2(to_log_fds[0], STDIN_FILENO);
				close(to_log_fds[0]);
				/* not needed */
				close(to_log_fds[1]);

				/* we don't need the client socket */
				for (i = 3; i < 256; i++) {
					close(i);
				}

				/* exec the log-process (skip the | )
				 *
				 */

				execl("/bin/sh", "sh", "-c", s->access_logfile->ptr + 1, (char *)NULL);

				log_error_write(srv, __FILE__, __LINE__, "sss",
						"spawning log-process failed: ", strerror(errno),
						s->access_logfile->ptr + 1);

				exit(-1);
				break;
			case -1:
				/* error */
				log_error_write(srv, __FILE__, __LINE__, "ss", "fork failed: ", strerror(errno));
				break;
			default:
				close(to_log_fds[0]);

				s->log_access_fd = to_log_fds[1];

				break;
			}
#else
			return -1;
#endif
		} else if (-1 == (s->log_access_fd =
				  open(s->access_logfile->ptr, O_APPEND | O_WRONLY | O_CREAT | O_LARGEFILE, 0644))) {

			log_error_write(srv, __FILE__, __LINE__, "ssb",
					"opening access-log failed:",
					strerror(errno), s->access_logfile);

			return HANDLER_ERROR;
		}
#ifndef _WIN32
		fcntl(s->log_access_fd, F_SETFD, FD_CLOEXEC);
#endif
	}

	return HANDLER_GO_ON;
}

SIGHUP_FUNC(log_access_cycle) {
	plugin_data *p = p_d;
	size_t i;

	if (!p->config_storage) return HANDLER_GO_ON;

	for (i = 0; i < srv->config_context->used; i++) {
		plugin_config *s = p->config_storage[i];

		if (s->access_logbuffer->used) {
			if (s->use_syslog) {
#ifdef HAVE_SYSLOG_H
				if (s->access_logbuffer->used > 2) {
					/* syslog appends a \n on its own */
					syslog(LOG_INFO, "%*s", (int) s->access_logbuffer->used - 2, s->access_logbuffer->ptr);
				}
#endif
			} else if (s->log_access_fd != -1) {
				write(s->log_access_fd, s->access_logbuffer->ptr, s->access_logbuffer->used - 1);
			}

			buffer_reset(s->access_logbuffer);
		}

		if (s->use_syslog == 0 &&
		    !buffer_is_empty(s->access_logfile) &&
		    s->access_logfile->ptr[0] != '|') {

			close(s->log_access_fd);

			if (-1 == (s->log_access_fd =
				   open(s->access_logfile->ptr, O_APPEND | O_WRONLY | O_CREAT | O_LARGEFILE, 0644))) {

				log_error_write(srv, __FILE__, __LINE__, "ss", "cycling access-log failed:", strerror(errno));

				return HANDLER_ERROR;
			}
		}
	}

	return HANDLER_GO_ON;
}

static int mod_accesslog_patch_connection(server *srv, connection *con, plugin_data *p) {
	size_t i, j;
	plugin_config *s = p->config_storage[0];

	PATCH_OPTION(access_logfile);
	PATCH_OPTION(format);
	PATCH_OPTION(log_access_fd);
	PATCH_OPTION(last_generated_accesslog_ts_ptr);
	PATCH_OPTION(access_logbuffer);
	PATCH_OPTION(ts_accesslog_str);
	PATCH_OPTION(parsed_format);
	PATCH_OPTION(use_syslog);

	/* skip the first, the global context */
	for (i = 1; i < srv->config_context->used; i++) {
		data_config *dc = (data_config *)srv->config_context->data[i];
		s = p->config_storage[i];

		/* condition didn't match */
		if (!config_check_cond(srv, con, dc)) continue;

		/* merge config */
		for (j = 0; j < dc->value->used; j++) {
			data_unset *du = dc->value->data[j];

			if (buffer_is_equal_string(du->key, CONST_STR_LEN("accesslog.filename"))) {
				PATCH_OPTION(access_logfile);
				PATCH_OPTION(log_access_fd);
				PATCH_OPTION(last_generated_accesslog_ts_ptr);
				PATCH_OPTION(access_logbuffer);
				PATCH_OPTION(ts_accesslog_str);
			} else if (buffer_is_equal_string(du->key, CONST_STR_LEN("accesslog.format"))) {
				PATCH_OPTION(format);
				PATCH_OPTION(parsed_format);
			} else if (buffer_is_equal_string(du->key, CONST_STR_LEN("accesslog.use-syslog"))) {
				PATCH_OPTION(use_syslog);
			}
		}
	}

	return 0;
}

REQUESTDONE_FUNC(log_access_write) {
	plugin_data *p = p_d;
	buffer *b;
	size_t j;

	int newts = 0;
	data_string *ds;

	mod_accesslog_patch_connection(srv, con, p);

	b = p->conf.access_logbuffer;
	if (b->used == 0) {
		buffer_copy_string_len(b, CONST_STR_LEN(""));
	}

	for (j = 0; j < p->conf.parsed_format->used; j++) {
		switch(p->conf.parsed_format->ptr[j]->type) {
		case FIELD_STRING:
			buffer_append_string_buffer(b, p->conf.parsed_format->ptr[j]->string);
			break;
		case FIELD_FORMAT:
			switch(p->conf.parsed_format->ptr[j]->field) {
			case FORMAT_TIMESTAMP:

				/* cache the generated timestamp */
				if (srv->cur_ts != *(p->conf.last_generated_accesslog_ts_ptr)) {
					struct tm tm;
#if defined(HAVE_STRUCT_TM_GMTOFF)
					long scd, hrs, min;
#endif

					buffer_prepare_copy(p->conf.ts_accesslog_str, 255);
#if defined(HAVE_STRUCT_TM_GMTOFF)
# ifdef HAVE_LOCALTIME_R
					localtime_r(&(srv->cur_ts), &tm);
					strftime(p->conf.ts_accesslog_str->ptr, p->conf.ts_accesslog_str->size - 1, "[%d/%b/%Y:%H:%M:%S ", &tm);
# else
					strftime(p->conf.ts_accesslog_str->ptr, p->conf.ts_accesslog_str->size - 1, "[%d/%b/%Y:%H:%M:%S ", localtime(&(srv->cur_ts)));
# endif
					p->conf.ts_accesslog_str->used = strlen(p->conf.ts_accesslog_str->ptr) + 1;

					buffer_append_string(p->conf.ts_accesslog_str, tm.tm_gmtoff >= 0 ? "+" : "-");

					scd = abs(tm.tm_gmtoff);
					hrs = scd / 3600;
					min = (scd % 3600) / 60;

					/* hours */
					if (hrs < 10) buffer_append_string_len(p->conf.ts_accesslog_str, CONST_STR_LEN("0"));
					buffer_append_long(p->conf.ts_accesslog_str, hrs);

					if (min < 10) buffer_append_string_len(p->conf.ts_accesslog_str, CONST_STR_LEN("0"));
					buffer_append_long(p->conf.ts_accesslog_str, min);
					buffer_append_string_len(p->conf.ts_accesslog_str, CONST_STR_LEN("]"));
#else
#ifdef HAVE_GMTIME_R
					gmtime_r(&(srv->cur_ts), &tm);
					strftime(p->conf.ts_accesslog_str->ptr, p->conf.ts_accesslog_str->size - 1, "[%d/%b/%Y:%H:%M:%S +0000]", &tm);
#else
					strftime(p->conf.ts_accesslog_str->ptr, p->conf.ts_accesslog_str->size - 1, "[%d/%b/%Y:%H:%M:%S +0000]", gmtime(&(srv->cur_ts)));
#endif
					p->conf.ts_accesslog_str->used = strlen(p->conf.ts_accesslog_str->ptr) + 1;
#endif

					*(p->conf.last_generated_accesslog_ts_ptr) = srv->cur_ts;
					newts = 1;
				}

				buffer_append_string_buffer(b, p->conf.ts_accesslog_str);

				break;
			case FORMAT_REMOTE_HOST:

				/* handle inet_ntop cache */

				buffer_append_string(b, inet_ntop_cache_get_ip(srv, &(con->dst_addr)));

				break;
			case FORMAT_REMOTE_IDENT:
				/* ident */
				buffer_append_string_len(b, CONST_STR_LEN("-"));
				break;
			case FORMAT_REMOTE_USER:
				if (con->authed_user->used > 1) {
					buffer_append_string_buffer(b, con->authed_user);
				} else {
					buffer_append_string_len(b, CONST_STR_LEN("-"));
				}
				break;
			case FORMAT_REQUEST_LINE:
				buffer_append_string(b, get_http_method_name(con->request.http_method));
				buffer_append_string_len(b, CONST_STR_LEN(" "));
				accesslog_append_escaped(b, con->request.orig_uri);
				buffer_append_string_len(b, CONST_STR_LEN(" "));
				buffer_append_string(b, get_http_version_name(con->request.http_version));

				break;
			case FORMAT_STATUS:
				buffer_append_long(b, con->http_status);
				break;

			case FORMAT_BYTES_OUT_NO_HEADER:
				if (con->bytes_written > 0) {
					buffer_append_off_t(b,
							    con->bytes_written - con->bytes_header <= 0 ? 0 : con->bytes_written - con->bytes_header);
				} else {
					buffer_append_string_len(b, CONST_STR_LEN("-"));
				}
				break;
			case FORMAT_HEADER:
				if (NULL != (ds = (data_string *)array_get_element(con->request.headers, CONST_BUF_LEN(p->conf.parsed_format->ptr[j]->string)))) {
					accesslog_append_escaped(b, ds->value);
				} else {
					buffer_append_string_len(b, CONST_STR_LEN("-"));
				}
				break;
			case FORMAT_RESPONSE_HEADER:
				if (NULL != (ds = (data_string *)array_get_element(con->response.headers, CONST_BUF_LEN(p->conf.parsed_format->ptr[j]->string)))) {
					accesslog_append_escaped(b, ds->value);
				} else {
					buffer_append_string_len(b, CONST_STR_LEN("-"));
				}
				break;
			case FORMAT_FILENAME:
				if (con->physical.path->used > 1) {
					buffer_append_string_buffer(b, con->physical.path);
				} else {
					buffer_append_string_len(b, CONST_STR_LEN("-"));
				}
				break;
			case FORMAT_BYTES_OUT:
				if (con->bytes_written > 0) {
					buffer_append_off_t(b, con->bytes_written);
				} else {
					buffer_append_string_len(b, CONST_STR_LEN("-"));
				}
				break;
			case FORMAT_BYTES_IN:
				if (con->bytes_read > 0) {
					buffer_append_off_t(b, con->bytes_read);
				} else {
					buffer_append_string_len(b, CONST_STR_LEN("-"));
				}
				break;
			case FORMAT_TIME_USED:
				buffer_append_long(b, srv->cur_ts - con->request_start);
				break;
			case FORMAT_SERVER_NAME:
				if (con->server_name->used > 1) {
					buffer_append_string_buffer(b, con->server_name);
				} else {
					buffer_append_string_len(b, CONST_STR_LEN("-"));
				}
				break;
			case FORMAT_HTTP_HOST:
				if (con->uri.authority->used > 1) {
					accesslog_append_escaped(b, con->uri.authority);
				} else {
					buffer_append_string_len(b, CONST_STR_LEN("-"));
				}
				break;
			case FORMAT_REQUEST_PROTOCOL:
				buffer_append_string(b,
						     con->request.http_version == HTTP_VERSION_1_1 ? "HTTP/1.1" : "HTTP/1.0");
				break;
			case FORMAT_REQUEST_METHOD:
				buffer_append_string(b, get_http_method_name(con->request.http_method));
				break;
			case FORMAT_SERVER_PORT:
				buffer_append_long(b, srv->srvconf.port);
				break;
			case FORMAT_QUERY_STRING:
				accesslog_append_escaped(b, con->uri.query);
				break;
			case FORMAT_URL:
				accesslog_append_escaped(b, con->uri.path_raw);
				break;
			case FORMAT_CONNECTION_STATUS:
				switch(con->keep_alive) {
				case 0: buffer_append_string_len(b, CONST_STR_LEN("-")); break;
				default: buffer_append_string_len(b, CONST_STR_LEN("+")); break;
				}
				break;
			default:
				/*
				 { 'a', FORMAT_REMOTE_ADDR },
				 { 'A', FORMAT_LOCAL_ADDR },
				 { 'C', FORMAT_COOKIE },
				 { 'D', FORMAT_TIME_USED_MS },
				 { 'e', FORMAT_ENV },
				 */

				break;
			}
			break;
		default:
			break;
		}
	}

	buffer_append_string_len(b, CONST_STR_LEN("\n"));

	if (p->conf.use_syslog ||  /* syslog doesn't cache */
	    (p->conf.access_logfile->used && p->conf.access_logfile->ptr[0] != '|') || /* pipes don't cache */
	    newts ||
	    b->used > BUFFER_MAX_REUSE_SIZE) {
		if (p->conf.use_syslog) {
#ifdef HAVE_SYSLOG_H
			if (b->used > 2) {
				/* syslog appends a \n on its own */
				syslog(LOG_INFO, "%*s", (int) b->used - 2, b->ptr);
			}
#endif
		} else if (p->conf.log_access_fd != -1) {
			write(p->conf.log_access_fd, b->ptr, b->used - 1);
		}
		buffer_reset(b);
	}

	return HANDLER_GO_ON;
}


LI_EXPORT int mod_accesslog_plugin_init(plugin *p);
LI_EXPORT int mod_accesslog_plugin_init(plugin *p) {
	p->version     = LIGHTTPD_VERSION_ID;
	p->name        = buffer_init_string("accesslog");

	p->init        = mod_accesslog_init;
	p->set_defaults= log_access_open;
	p->cleanup     = mod_accesslog_free;

	p->handle_response_done  = log_access_write;
	p->handle_sighup         = log_access_cycle;

	p->data        = NULL;

	return 0;
}
