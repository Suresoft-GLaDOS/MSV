#define __COMPILE_0
#define __COMPILE_1
#define __COMPILE_2
#define __COMPILE_3
#define __COMPILE_4
#define __COMPILE_5
#define __COMPILE_6
#define __COMPILE_7
#define __COMPILE_8
#define __COMPILE_9
#define __COMPILE_10
#define __COMPILE_11
#define __COMPILE_12
#define __COMPILE_13
#define __COMPILE_14
#define __COMPILE_15
#define __COMPILE_16
#define __COMPILE_17
#define __COMPILE_18
#define __COMPILE_19
#define __COMPILE_20
#define __COMPILE_21
#define __COMPILE_22
#define __COMPILE_23
#define __COMPILE_24
#define __COMPILE_25
#define __COMPILE_26
#define __COMPILE_27
#define __COMPILE_28
#define __COMPILE_29
#define __COMPILE_30
#define __COMPILE_31
#define __COMPILE_32
#define __COMPILE_33
#define __COMPILE_34
#define __COMPILE_35
#define __COMPILE_36
#define __COMPILE_37
#define __COMPILE_38
#define __COMPILE_39
#define __COMPILE_40
#define __COMPILE_41
#define __COMPILE_42
#define __COMPILE_43
#define __COMPILE_44
#define __COMPILE_45
#define __COMPILE_46
#define __COMPILE_47
#define __COMPILE_49
#define __COMPILE_50
#define __COMPILE_51
#define __COMPILE_52
#define __COMPILE_53
#define __COMPILE_54
#define __COMPILE_55
#define __COMPILE_56
#define __COMPILE_57
#define __COMPILE_58
#define __COMPILE_59
#define __COMPILE_60
#define __COMPILE_61
#define __COMPILE_62
#define __COMPILE_63
#define __COMPILE_64
#define __COMPILE_65
#define __COMPILE_66
#define __COMPILE_67
#define __COMPILE_68
#define __COMPILE_69
#define __COMPILE_70
#define __COMPILE_71
#define __COMPILE_72
#define __COMPILE_73
#define __COMPILE_74
#define __COMPILE_75
#define __COMPILE_76
#define __COMPILE_77
#define __COMPILE_78
#define __COMPILE_79
#define __COMPILE_80
#define __COMPILE_81
#define __COMPILE_82
#define __COMPILE_83
#define __COMPILE_84
#define __COMPILE_85
#define __COMPILE_86
#define __COMPILE_87
#define __COMPILE_88
#define __COMPILE_89
#define __COMPILE_90
#define __COMPILE_91
#define __COMPILE_92
#define __COMPILE_93
#define __COMPILE_94
#define __COMPILE_95
#define __COMPILE_96
#define __COMPILE_97
#define __COMPILE_98
#define __COMPILE_99
#define __COMPILE_100
#define __COMPILE_101
#define __COMPILE_102
#define __COMPILE_103
#define __COMPILE_104
#define __COMPILE_105
#define __COMPILE_106
#define __COMPILE_107
#define __COMPILE_108
#define __COMPILE_109
#define __COMPILE_110
#define __COMPILE_111
#define __COMPILE_113
#define __COMPILE_114
#define __COMPILE_115
#define __COMPILE_116
#define __COMPILE_117
#define __COMPILE_118
#define __COMPILE_119
#define __COMPILE_120
#define __COMPILE_121
#define __COMPILE_122
#define __COMPILE_123
#define __COMPILE_124
#define __COMPILE_125
#define __COMPILE_126
#define __COMPILE_127
#define __COMPILE_128
#define __COMPILE_129
#define __COMPILE_130
#define __COMPILE_131
#define __COMPILE_132
#define __COMPILE_133
#define __COMPILE_134
#define __COMPILE_135
#define __COMPILE_136
#define __COMPILE_137
#define __COMPILE_138
#define __COMPILE_139
#define __COMPILE_141
#define __COMPILE_142
#define __COMPILE_143
#define __COMPILE_144
#define __COMPILE_145
#define __COMPILE_146
#define __COMPILE_147
#define __COMPILE_148
#define __COMPILE_149
#define __COMPILE_150
#define __COMPILE_151
#define __COMPILE_152
#define __COMPILE_153
#define __COMPILE_154
#define __COMPILE_155
#define __COMPILE_156
#define __COMPILE_157
#define __COMPILE_158
#define __COMPILE_159
#define __COMPILE_160
#define __COMPILE_161
#define __COMPILE_162
#define __COMPILE_163
#define __COMPILE_164
#define __COMPILE_165
#define __COMPILE_166
#define __COMPILE_167
#define __COMPILE_168
#define __COMPILE_169
#define __COMPILE_170
#define __COMPILE_171
#define __COMPILE_172
#define __COMPILE_173
#define __COMPILE_174
#define __COMPILE_175
#define __COMPILE_176
#define __COMPILE_177
#define __COMPILE_178
#define __COMPILE_179
#define __COMPILE_180
#define __COMPILE_181
#define __COMPILE_182
#define __COMPILE_183
#define __COMPILE_184
#define __COMPILE_185
#define __COMPILE_186
#define __COMPILE_187
#define __COMPILE_188
#define __COMPILE_189
#define __COMPILE_190
#define __COMPILE_191
#define __COMPILE_192
#define __COMPILE_193
#define __COMPILE_194
#define __COMPILE_195
#define __COMPILE_196
#define __COMPILE_197
#define __COMPILE_198
#define __COMPILE_199
#define __COMPILE_200
// compile_fin
int __get_mutant(); int __is_neg(const char *location,char *lid,int count, ...); int __abst_hole(); char *__stat_write_init(const char *func_name);void __write_stat(char *str,const char *var_name,void *var_addr,int size); void __stat_file_close(const char *func_name,char *str);long long __mutate(const long long,const char *,const char *); int __trident_choice(char* lid, char* typestr,int* rvals, char** rvals_ids, int rvals_size,int** lvals, char** lvals_ids, int lvals_size);int __trident_output(char* id, char* typestr, int value);float fabs_trident(float a);int __choose(const char *);void *__var_select(unsigned int var_count,void *vars[]);void *__var_select_2(unsigned int var_count,void *vars[]);long long __const_select(unsigned int const_count, ...);void* memset(void*, int, unsigned long); 
/*
  +----------------------------------------------------------------------+
  | PHP Version 5                                                        |
  +----------------------------------------------------------------------+
  | Copyright (c) 1997-2011 The PHP Group                                |
  +----------------------------------------------------------------------+
  | This source file is subject to version 3.0 of the PHP license,       |
  | that is bundled with this package in the file LICENSE, and is        |
  | available through the world-wide-web at the following url:           |
  | http://www.php.net/license/3_0.txt.                                  |
  | If you did not receive a copy of the PHP license and are unable to   |
  | obtain it through the world-wide-web, please send a note to          |
  | license@php.net so we can mail you a copy immediately.               |
  +----------------------------------------------------------------------+
  | Author: Ilia Alshanetsky <ilia@php.net>                              |
  +----------------------------------------------------------------------+
*/

/* $Id$ */

#ifdef HAVE_CONFIG_H
#include "config.h"
#endif
#include "php.h"

#include <magic.h>
/* 
 * HOWMANY specifies the maximum offset libmagic will look at
 * this is currently hardcoded in the libmagic source but not exported
 */
#ifndef HOWMANY
#define HOWMANY 65536
#endif

#include "php_ini.h"
#include "ext/standard/info.h"
#include "ext/standard/file.h" /* needed for context stuff */
#include "php_fileinfo.h"
#include "fopen_wrappers.h" /* needed for is_url */

#ifndef _S_IFDIR
# define _S_IFDIR		S_IFDIR
#endif

/* {{{ macros and type definitions */
struct php_fileinfo {
	long options;
	struct magic_set *magic;
};

static zend_object_handlers finfo_object_handlers;
zend_class_entry *finfo_class_entry;

struct finfo_object {
	zend_object zo;
	struct php_fileinfo *ptr;
};

#define FILEINFO_DECLARE_INIT_OBJECT(object) \
	zval *object = getThis();

#define FILEINFO_REGISTER_OBJECT(_object, _ptr) \
{ \
	struct finfo_object *obj; \
        obj = (struct finfo_object*)zend_object_store_get_object(_object TSRMLS_CC); \
        obj->ptr = _ptr; \
}

#define FILEINFO_FROM_OBJECT(finfo, object) \
{ \
	struct finfo_object *obj = zend_object_store_get_object(object TSRMLS_CC); \
	finfo = obj->ptr; \
	if (!finfo) { \
        	php_error_docref(NULL TSRMLS_CC, E_WARNING, "The invalid fileinfo object."); \
		RETURN_FALSE; \
	} \
}

/* {{{ finfo_objects_dtor
 */
static void finfo_objects_dtor(void *object, zend_object_handle handle TSRMLS_DC)
{
	struct finfo_object *intern = (struct finfo_object *) object;

	if (intern->ptr) {
		magic_close(intern->ptr->magic);
		efree(intern->ptr);
	}

	zend_object_std_dtor(&intern->zo TSRMLS_CC);
	efree(intern);
}
/* }}} */

/* {{{ finfo_objects_new
 */
PHP_FILEINFO_API zend_object_value finfo_objects_new(zend_class_entry *class_type TSRMLS_DC)
{
	zend_object_value retval;
	struct finfo_object *intern;

	intern = emalloc(sizeof(struct finfo_object));
	memset(intern, 0, sizeof(struct finfo_object));

	zend_object_std_init(&intern->zo, class_type TSRMLS_CC);
	object_properties_init(&intern->zo, class_type);

	intern->ptr = NULL;

	retval.handle = zend_objects_store_put(intern, finfo_objects_dtor, NULL, NULL TSRMLS_CC);
	retval.handlers = (zend_object_handlers *) &finfo_object_handlers;

	return retval;
}
/* }}} */

/* {{{ arginfo */
ZEND_BEGIN_ARG_INFO_EX(arginfo_finfo_open, 0, 0, 0)
	ZEND_ARG_INFO(0, options)
	ZEND_ARG_INFO(0, arg)
ZEND_END_ARG_INFO()

ZEND_BEGIN_ARG_INFO_EX(arginfo_finfo_close, 0, 0, 1)
	ZEND_ARG_INFO(0, finfo)
ZEND_END_ARG_INFO()

ZEND_BEGIN_ARG_INFO_EX(arginfo_finfo_set_flags, 0, 0, 2)
	ZEND_ARG_INFO(0, finfo)
	ZEND_ARG_INFO(0, options)
ZEND_END_ARG_INFO()

ZEND_BEGIN_ARG_INFO_EX(arginfo_finfo_method_set_flags, 0, 0, 1)
	ZEND_ARG_INFO(0, options)
ZEND_END_ARG_INFO()

ZEND_BEGIN_ARG_INFO_EX(arginfo_finfo_file, 0, 0, 2)
	ZEND_ARG_INFO(0, finfo)
	ZEND_ARG_INFO(0, filename)
	ZEND_ARG_INFO(0, options)
	ZEND_ARG_INFO(0, context)
ZEND_END_ARG_INFO()

ZEND_BEGIN_ARG_INFO_EX(arginfo_finfo_method_file, 0, 0, 1)
	ZEND_ARG_INFO(0, filename)
	ZEND_ARG_INFO(0, options)
	ZEND_ARG_INFO(0, context)
ZEND_END_ARG_INFO()

ZEND_BEGIN_ARG_INFO_EX(arginfo_finfo_buffer, 0, 0, 2)
	ZEND_ARG_INFO(0, finfo)
	ZEND_ARG_INFO(0, string)
	ZEND_ARG_INFO(0, options)
	ZEND_ARG_INFO(0, context)
ZEND_END_ARG_INFO()

ZEND_BEGIN_ARG_INFO_EX(arginfo_finfo_method_buffer, 0, 0, 1)
	ZEND_ARG_INFO(0, string)
	ZEND_ARG_INFO(0, options)
	ZEND_ARG_INFO(0, context)
ZEND_END_ARG_INFO()

ZEND_BEGIN_ARG_INFO_EX(arginfo_mime_content_type, 0, 0, 1)
	ZEND_ARG_INFO(0, string)
ZEND_END_ARG_INFO()
/* }}} */

/* {{{ finfo_class_functions
 */
zend_function_entry finfo_class_functions[] = {
	ZEND_ME_MAPPING(finfo,          finfo_open,     arginfo_finfo_open, ZEND_ACC_PUBLIC)
	ZEND_ME_MAPPING(set_flags,      finfo_set_flags,arginfo_finfo_method_set_flags, ZEND_ACC_PUBLIC)
	ZEND_ME_MAPPING(file,           finfo_file,     arginfo_finfo_method_file, ZEND_ACC_PUBLIC)
	ZEND_ME_MAPPING(buffer,         finfo_buffer,   arginfo_finfo_method_buffer, ZEND_ACC_PUBLIC)
	{NULL, NULL, NULL}
};
/* }}} */

#define FINFO_SET_OPTION(magic, options) \
	if (magic_setflags(magic, options) == -1) { \
		php_error_docref(NULL TSRMLS_CC, E_WARNING, "Failed to set option '%ld' %d:%s", \
				options, magic_errno(magic), magic_error(magic)); \
		RETURN_FALSE; \
	}

/* True global resources - no need for thread safety here */
static int le_fileinfo;
/* }}} */

void finfo_resource_destructor(zend_rsrc_list_entry *rsrc TSRMLS_DC) /* {{{ */
{
	if (rsrc->ptr) {
		struct php_fileinfo *finfo = (struct php_fileinfo *) rsrc->ptr;
		magic_close(finfo->magic);
		efree(rsrc->ptr);
		rsrc->ptr = NULL;
	}
}
/* }}} */


/* {{{ fileinfo_functions[]
 */
zend_function_entry fileinfo_functions[] = {
	PHP_FE(finfo_open,		arginfo_finfo_open)
	PHP_FE(finfo_close,		arginfo_finfo_close)
	PHP_FE(finfo_set_flags,	arginfo_finfo_set_flags)
	PHP_FE(finfo_file,		arginfo_finfo_file)
	PHP_FE(finfo_buffer,	arginfo_finfo_buffer)
	PHP_FE(mime_content_type, arginfo_mime_content_type)
	{NULL, NULL, NULL}
};
/* }}} */

/* {{{ PHP_MINIT_FUNCTION
 */
PHP_MINIT_FUNCTION(finfo)
{
	zend_class_entry _finfo_class_entry;
	INIT_CLASS_ENTRY(_finfo_class_entry, "finfo", finfo_class_functions);
	_finfo_class_entry.create_object = finfo_objects_new;
	finfo_class_entry = zend_register_internal_class(&_finfo_class_entry TSRMLS_CC);

	/* copy the standard object handlers to you handler table */
	memcpy(&finfo_object_handlers, zend_get_std_object_handlers(), sizeof(zend_object_handlers));

	le_fileinfo = zend_register_list_destructors_ex(finfo_resource_destructor, NULL, "file_info", module_number);

	REGISTER_LONG_CONSTANT("FILEINFO_NONE",			MAGIC_NONE, CONST_CS|CONST_PERSISTENT);
	REGISTER_LONG_CONSTANT("FILEINFO_SYMLINK",		MAGIC_SYMLINK, CONST_CS|CONST_PERSISTENT);
	REGISTER_LONG_CONSTANT("FILEINFO_MIME",			MAGIC_MIME, CONST_CS|CONST_PERSISTENT);
	REGISTER_LONG_CONSTANT("FILEINFO_MIME_TYPE",	MAGIC_MIME_TYPE, CONST_CS|CONST_PERSISTENT);
	REGISTER_LONG_CONSTANT("FILEINFO_MIME_ENCODING",MAGIC_MIME_ENCODING, CONST_CS|CONST_PERSISTENT);
/*	REGISTER_LONG_CONSTANT("FILEINFO_COMPRESS",		MAGIC_COMPRESS, CONST_CS|CONST_PERSISTENT); disabled, as it does fork now */
	REGISTER_LONG_CONSTANT("FILEINFO_DEVICES",		MAGIC_DEVICES, CONST_CS|CONST_PERSISTENT);
	REGISTER_LONG_CONSTANT("FILEINFO_CONTINUE",		MAGIC_CONTINUE, CONST_CS|CONST_PERSISTENT);
#ifdef MAGIC_PRESERVE_ATIME
	REGISTER_LONG_CONSTANT("FILEINFO_PRESERVE_ATIME",	MAGIC_PRESERVE_ATIME, CONST_CS|CONST_PERSISTENT);
#endif
#ifdef MAGIC_RAW
	REGISTER_LONG_CONSTANT("FILEINFO_RAW",			MAGIC_RAW, CONST_CS|CONST_PERSISTENT);
#endif

	return SUCCESS;
}
/* }}} */

/* {{{ fileinfo_module_entry
 */
zend_module_entry fileinfo_module_entry = {
	STANDARD_MODULE_HEADER,
	"fileinfo",
	fileinfo_functions,
	PHP_MINIT(finfo),
	NULL,
	NULL,	
	NULL,
	PHP_MINFO(fileinfo),
	PHP_FILEINFO_VERSION,
	STANDARD_MODULE_PROPERTIES
};
/* }}} */

#ifdef COMPILE_DL_FILEINFO
ZEND_GET_MODULE(fileinfo)
#endif

/* {{{ PHP_MINFO_FUNCTION
 */
PHP_MINFO_FUNCTION(fileinfo)
{
	php_info_print_table_start();
	php_info_print_table_header(2, "fileinfo support", "enabled");
	php_info_print_table_row(2, "version", PHP_FILEINFO_VERSION);
	php_info_print_table_end();
}
/* }}} */

/* {{{ proto resource finfo_open([int options [, string arg]])
   Create a new fileinfo resource. */
PHP_FUNCTION(finfo_open)
{
	long options = MAGIC_NONE;
	char *file = NULL;
	int file_len = 0;
	struct php_fileinfo *finfo;
	FILEINFO_DECLARE_INIT_OBJECT(object)
	char resolved_path[MAXPATHLEN];

	if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, "|ls", &options, &file, &file_len) == FAILURE) {
		RETURN_FALSE;
	}

	if (file_len == 0) {
		file = NULL;
	} else if (file && *file) { /* user specified file, perform open_basedir checks */
		if (!VCWD_REALPATH(file, resolved_path)) {
			RETURN_FALSE;
		}
		file = resolved_path;

#if PHP_API_VERSION < 20100412
		if ((PG(safe_mode) && (!php_checkuid(file, NULL, CHECKUID_CHECK_FILE_AND_DIR))) || php_check_open_basedir(file TSRMLS_CC)) {
#else
		if (php_check_open_basedir(file TSRMLS_CC)) {
#endif
			RETURN_FALSE;
		}
	}

	finfo = emalloc(sizeof(struct php_fileinfo));

	finfo->options = options;
	finfo->magic = magic_open(options);

	if (finfo->magic == NULL) {
		efree(finfo);
		php_error_docref(NULL TSRMLS_CC, E_WARNING, "Invalid mode '%ld'.", options);
		RETURN_FALSE;	
	}

	if (magic_load(finfo->magic, file) == -1) {
		php_error_docref(NULL TSRMLS_CC, E_WARNING, "Failed to load magic database at '%s'.", file);
		magic_close(finfo->magic);
		efree(finfo);
		RETURN_FALSE;
	}	

	if (object) {
		FILEINFO_REGISTER_OBJECT(object, finfo);
	} else {
		ZEND_REGISTER_RESOURCE(return_value, finfo, le_fileinfo);
	}	
}
/* }}} */

/* {{{ proto resource finfo_close(resource finfo)
   Close fileinfo resource. */
PHP_FUNCTION(finfo_close)
{
	struct php_fileinfo *finfo;
	zval *zfinfo;

	if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, "r", &zfinfo) == FAILURE) {
		RETURN_FALSE;
	}
	ZEND_FETCH_RESOURCE(finfo, struct php_fileinfo *, &zfinfo, -1, "file_info", le_fileinfo);

	zend_list_delete(Z_RESVAL_P(zfinfo));

	RETURN_TRUE;
}
/* }}} */

/* {{{ proto bool finfo_set_flags(resource finfo, int options)
   Set libmagic configuration options. */
PHP_FUNCTION(finfo_set_flags)
{
	long options;
	struct php_fileinfo *finfo;
	zval *zfinfo;
	FILEINFO_DECLARE_INIT_OBJECT(object)

	if (object) {
		if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, "l", &options) == FAILURE) {
			RETURN_FALSE;
		}
		FILEINFO_FROM_OBJECT(finfo, object);
	} else {
		if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, "rl", &zfinfo, &options) == FAILURE) {
			RETURN_FALSE;
		}
		ZEND_FETCH_RESOURCE(finfo, struct php_fileinfo *, &zfinfo, -1, "file_info", le_fileinfo);
	}

	FINFO_SET_OPTION(finfo->magic, options)
	finfo->options = options;

	RETURN_TRUE;
}
/* }}} */

#define FILEINFO_MODE_BUFFER 0
#define FILEINFO_MODE_STREAM 1
#define FILEINFO_MODE_FILE 2

static void _php_finfo_get_type(INTERNAL_FUNCTION_PARAMETERS, int mode, int mimetype_emu) /* {{{ */
{
	long options = 0;
	char *ret_val = NULL, *buffer = NULL;
	int buffer_len;
	struct php_fileinfo *finfo;
	zval *zfinfo, *zcontext = NULL;
	zval *what;
	char mime_directory[] = "directory";

	struct magic_set *magic = NULL;
	FILEINFO_DECLARE_INIT_OBJECT(object)

	if (mimetype_emu) {

		/* mime_content_type(..) emulation */
		if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, "z", &what) == FAILURE) {
			return;
		}

		switch (Z_TYPE_P(what)) {
			case IS_STRING:
				buffer = Z_STRVAL_P(what);
				buffer_len = Z_STRLEN_P(what);
				mode = FILEINFO_MODE_FILE;
				break;

			case IS_RESOURCE:
				mode = FILEINFO_MODE_STREAM;
				break;

			default:
				php_error_docref(NULL TSRMLS_CC, E_WARNING, "Can only process string or stream arguments");
				RETURN_FALSE;
		}

		magic = magic_open(MAGIC_MIME_TYPE);
		if (magic_load(magic, NULL) == -1) {
			php_error_docref(NULL TSRMLS_CC, E_WARNING, "Failed to load magic database.");
			goto common;
		}
	} else if (object) {
		if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, "s|lr", &buffer, &buffer_len, &options, &zcontext) == FAILURE) {
			RETURN_FALSE;
		}
		FILEINFO_FROM_OBJECT(finfo, object);
		magic = finfo->magic;
	} else {
		if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, "rs|lr", &zfinfo, &buffer, &buffer_len, &options, &zcontext) == FAILURE) {
			RETURN_FALSE;
		}
		ZEND_FETCH_RESOURCE(finfo, struct php_fileinfo *, &zfinfo, -1, "file_info", le_fileinfo);
		magic = finfo->magic;
	}	

	/* Set options for the current file/buffer. */
	if (options) {
		FINFO_SET_OPTION(magic, options)
	}

	switch (mode) {
		case FILEINFO_MODE_BUFFER:
		{
			ret_val = (char *) magic_buffer(magic, buffer, buffer_len);
			break;
		}

		case FILEINFO_MODE_STREAM:
		{
				php_stream *stream;
				off_t streampos;

				php_stream_from_zval_no_verify(stream, &what);
				if (!stream) {
					goto common;
				}

				streampos = php_stream_tell(stream); /* remember stream position for restoration */
				php_stream_seek(stream, 0, SEEK_SET);

				ret_val = (char *) magic_stream(magic, stream);

				php_stream_seek(stream, streampos, SEEK_SET);
				break;
		}

		case FILEINFO_MODE_FILE:
		{
			/* determine if the file is a local file or remote URL */
			char *tmp2;
			php_stream_wrapper *wrap;
			struct stat sb;

			if (buffer == NULL || !*buffer) {
				php_error_docref(NULL TSRMLS_CC, E_WARNING, "Empty filename or path");
				RETVAL_FALSE;
				//prophet generated patch
				{
				int __choose0 = __choose("__SWITCH0");
				if (__choose0 == 0)
				{}
				#ifdef __COMPILE_0
				else if (__choose0 == 1)
				{
				//AddIfStmtKind
				if (mimetype_emu) {
				    magic_close(magic);
				}
				}
				#endif
				#ifdef __COMPILE_1
				else if (__choose0 == 2)
				{
				//AddIfStmtKind
				if (zend_parse_parameters((ht), "z", &what) == -1) {
				    return;
				}
				}
				#endif
				#ifdef __COMPILE_2
				else if (__choose0 == 3)
				{
				//AddStmtAndReplaceAtomKind
				(buffer)++;
				}
				#endif
				#ifdef __COMPILE_3
				else if (__choose0 == 4)
				{
				//AddStmtAndReplaceAtomKind
				(ret_val)++;
				}
				#endif
				#ifdef __COMPILE_4
				else if (__choose0 == 5)
				{
				//AddStmtAndReplaceAtomKind
				(tmp2)++;
				}
				#endif
				#ifdef __COMPILE_5
				else if (__choose0 == 6)
				{
				//AddStmtAndReplaceAtomKind
				_efree(((finfo)));
				}
				#endif
				#ifdef __COMPILE_6
				else if (__choose0 == 7)
				{
				//AddStmtAndReplaceAtomKind
				_efree(((object)));
				}
				#endif
				#ifdef __COMPILE_7
				else if (__choose0 == 8)
				{
				//AddStmtAndReplaceAtomKind
				_efree(((return_value)));
				}
				#endif
				#ifdef __COMPILE_8
				else if (__choose0 == 9)
				{
				//AddStmtAndReplaceAtomKind
				_efree(((this_ptr)));
				}
				#endif
				#ifdef __COMPILE_9
				else if (__choose0 == 10)
				{
				//AddStmtAndReplaceAtomKind
				_efree(((what)));
				}
				#endif
				#ifdef __COMPILE_10
				else if (__choose0 == 11)
				{
				//AddStmtAndReplaceAtomKind
				_efree(((zcontext)));
				}
				#endif
				#ifdef __COMPILE_11
				else if (__choose0 == 12)
				{
				//AddStmtAndReplaceAtomKind
				_efree(((zfinfo)));
				}
				#endif
				#ifdef __COMPILE_12
				else if (__choose0 == 13)
				{
				//AddStmtAndReplaceAtomKind
				_zend_list_delete((*(object)).value.lval);
				}
				#endif
				#ifdef __COMPILE_13
				else if (__choose0 == 14)
				{
				//AddStmtAndReplaceAtomKind
				_zend_list_delete((*(return_value)).value.lval);
				}
				#endif
				#ifdef __COMPILE_14
				else if (__choose0 == 15)
				{
				//AddStmtAndReplaceAtomKind
				_zend_list_delete((*(this_ptr)).value.lval);
				}
				#endif
				#ifdef __COMPILE_15
				else if (__choose0 == 16)
				{
				//AddStmtAndReplaceAtomKind
				_zend_list_delete((*(what)).value.lval);
				}
				#endif
				#ifdef __COMPILE_16
				else if (__choose0 == 17)
				{
				//AddStmtAndReplaceAtomKind
				_zend_list_delete((*(zcontext)).value.lval);
				}
				#endif
				#ifdef __COMPILE_17
				else if (__choose0 == 18)
				{
				//AddStmtAndReplaceAtomKind
				_zend_list_delete((*(zfinfo)).value.lval);
				}
				#endif
				#ifdef __COMPILE_18
				else if (__choose0 == 19)
				{
				//AddStmtAndReplaceAtomKind
				_zval_copy_ctor_func((object));
				}
				#endif
				#ifdef __COMPILE_19
				else if (__choose0 == 20)
				{
				//AddStmtAndReplaceAtomKind
				_zval_copy_ctor_func((return_value));
				}
				#endif
				#ifdef __COMPILE_20
				else if (__choose0 == 21)
				{
				//AddStmtAndReplaceAtomKind
				_zval_copy_ctor_func((this_ptr));
				}
				#endif
				#ifdef __COMPILE_21
				else if (__choose0 == 22)
				{
				//AddStmtAndReplaceAtomKind
				_zval_copy_ctor_func((what));
				}
				#endif
				#ifdef __COMPILE_22
				else if (__choose0 == 23)
				{
				//AddStmtAndReplaceAtomKind
				_zval_copy_ctor_func((zcontext));
				}
				#endif
				#ifdef __COMPILE_23
				else if (__choose0 == 24)
				{
				//AddStmtAndReplaceAtomKind
				_zval_copy_ctor_func((zfinfo));
				}
				#endif
				#ifdef __COMPILE_24
				else if (__choose0 == 25)
				{
				//AddStmtAndReplaceAtomKind
				_zval_dtor(((object)));
				}
				#endif
				#ifdef __COMPILE_25
				else if (__choose0 == 26)
				{
				//AddStmtAndReplaceAtomKind
				_zval_dtor(((return_value)));
				}
				#endif
				#ifdef __COMPILE_26
				else if (__choose0 == 27)
				{
				//AddStmtAndReplaceAtomKind
				_zval_dtor(((this_ptr)));
				}
				#endif
				#ifdef __COMPILE_27
				else if (__choose0 == 28)
				{
				//AddStmtAndReplaceAtomKind
				_zval_dtor(((what)));
				}
				#endif
				#ifdef __COMPILE_28
				else if (__choose0 == 29)
				{
				//AddStmtAndReplaceAtomKind
				_zval_dtor(((zcontext)));
				}
				#endif
				#ifdef __COMPILE_29
				else if (__choose0 == 30)
				{
				//AddStmtAndReplaceAtomKind
				_zval_dtor(((zfinfo)));
				}
				#endif
				#ifdef __COMPILE_30
				else if (__choose0 == 31)
				{
				//AddStmtAndReplaceAtomKind
				_zval_dtor_func((object));
				}
				#endif
				#ifdef __COMPILE_31
				else if (__choose0 == 32)
				{
				//AddStmtAndReplaceAtomKind
				_zval_dtor_func((return_value));
				}
				#endif
				#ifdef __COMPILE_32
				else if (__choose0 == 33)
				{
				//AddStmtAndReplaceAtomKind
				_zval_dtor_func((this_ptr));
				}
				#endif
				#ifdef __COMPILE_33
				else if (__choose0 == 34)
				{
				//AddStmtAndReplaceAtomKind
				_zval_dtor_func((what));
				}
				#endif
				#ifdef __COMPILE_34
				else if (__choose0 == 35)
				{
				//AddStmtAndReplaceAtomKind
				_zval_dtor_func((zcontext));
				}
				#endif
				#ifdef __COMPILE_35
				else if (__choose0 == 36)
				{
				//AddStmtAndReplaceAtomKind
				_zval_dtor_func((zfinfo));
				}
				#endif
				#ifdef __COMPILE_36
				else if (__choose0 == 37)
				{
				//AddStmtAndReplaceAtomKind
				_zval_ptr_dtor((&(object)));
				}
				#endif
				#ifdef __COMPILE_37
				else if (__choose0 == 38)
				{
				//AddStmtAndReplaceAtomKind
				_zval_ptr_dtor((&(return_value)));
				}
				#endif
				#ifdef __COMPILE_38
				else if (__choose0 == 39)
				{
				//AddStmtAndReplaceAtomKind
				_zval_ptr_dtor((&(this_ptr)));
				}
				#endif
				#ifdef __COMPILE_39
				else if (__choose0 == 40)
				{
				//AddStmtAndReplaceAtomKind
				_zval_ptr_dtor((&(what)));
				}
				#endif
				#ifdef __COMPILE_40
				else if (__choose0 == 41)
				{
				//AddStmtAndReplaceAtomKind
				_zval_ptr_dtor((&(zcontext)));
				}
				#endif
				#ifdef __COMPILE_41
				else if (__choose0 == 42)
				{
				//AddStmtAndReplaceAtomKind
				_zval_ptr_dtor((&(zfinfo)));
				}
				#endif
				#ifdef __COMPILE_42
				else if (__choose0 == 43)
				{
				//AddStmtAndReplaceAtomKind
				buffer_len = (*(object)).value.str.len;
				}
				#endif
				#ifdef __COMPILE_43
				else if (__choose0 == 44)
				{
				//AddStmtAndReplaceAtomKind
				buffer_len = (*(return_value)).value.str.len;
				}
				#endif
				#ifdef __COMPILE_44
				else if (__choose0 == 45)
				{
				//AddStmtAndReplaceAtomKind
				buffer_len = (*(this_ptr)).value.str.len;
				}
				#endif
				#ifdef __COMPILE_45
				else if (__choose0 == 46)
				{
				//AddStmtAndReplaceAtomKind
				buffer_len = (*(what)).value.str.len;
				}
				#endif
				#ifdef __COMPILE_46
				else if (__choose0 == 47)
				{
				//AddStmtAndReplaceAtomKind
				buffer_len = (*(zcontext)).value.str.len;
				}
				#endif
				#ifdef __COMPILE_47
				else if (__choose0 == 48)
				{
				//AddStmtAndReplaceAtomKind
				buffer_len = (*(zfinfo)).value.str.len;
				}
				#endif
				#ifdef __COMPILE_48
				else if (__choose0 == 49)
				{
				//AddStmtAndReplaceAtomKind
				buffer_len = (*what && !(1 << 5)).value.str.len;
				}
				#endif
				#ifdef __COMPILE_49
				else if (__choose0 == 50)
				{
				//AddStmtAndReplaceAtomKind
				buffer_len = (-1);
				}
				#endif
				#ifdef __COMPILE_50
				else if (__choose0 == 51)
				{
				//AddStmtAndReplaceAtomKind
				buffer_len = (0);
				}
				#endif
				#ifdef __COMPILE_51
				else if (__choose0 == 52)
				{
				//AddStmtAndReplaceAtomKind
				buffer_len = (1);
				}
				#endif
				#ifdef __COMPILE_52
				else if (__choose0 == 53)
				{
				//AddStmtAndReplaceAtomKind
				buffer_len = (16);
				}
				#endif
				#ifdef __COMPILE_53
				else if (__choose0 == 54)
				{
				//AddStmtAndReplaceAtomKind
				buffer_len = (16384);
				}
				#endif
				#ifdef __COMPILE_54
				else if (__choose0 == 55)
				{
				//AddStmtAndReplaceAtomKind
				buffer_len = (2);
				}
				#endif
				#ifdef __COMPILE_55
				else if (__choose0 == 56)
				{
				//AddStmtAndReplaceAtomKind
				buffer_len = (3);
				}
				#endif
				#ifdef __COMPILE_56
				else if (__choose0 == 57)
				{
				//AddStmtAndReplaceAtomKind
				buffer_len = (6);
				}
				#endif
				#ifdef __COMPILE_57
				else if (__choose0 == 58)
				{
				//AddStmtAndReplaceAtomKind
				buffer_len = (7);
				}
				#endif
				#ifdef __COMPILE_58
				else if (__choose0 == 59)
				{
				//AddStmtAndReplaceAtomKind
				buffer_len = (8);
				}
				#endif
				#ifdef __COMPILE_59
				else if (__choose0 == 60)
				{
				//AddStmtAndReplaceAtomKind
				buffer_len = (buffer_len);
				}
				#endif
				#ifdef __COMPILE_60
				else if (__choose0 == 61)
				{
				//AddStmtAndReplaceAtomKind
				buffer_len = (ht);
				}
				#endif
				#ifdef __COMPILE_61
				else if (__choose0 == 62)
				{
				//AddStmtAndReplaceAtomKind
				buffer_len = (mimetype_emu);
				}
				#endif
				#ifdef __COMPILE_62
				else if (__choose0 == 63)
				{
				//AddStmtAndReplaceAtomKind
				buffer_len = (mode);
				}
				#endif
				#ifdef __COMPILE_63
				else if (__choose0 == 64)
				{
				//AddStmtAndReplaceAtomKind
				buffer_len = (return_value_used);
				}
				#endif
				#ifdef __COMPILE_64
				else if (__choose0 == 65)
				{
				//AddStmtAndReplaceAtomKind
				convert_to_boolean((object));
				}
				#endif
				#ifdef __COMPILE_65
				else if (__choose0 == 66)
				{
				//AddStmtAndReplaceAtomKind
				convert_to_boolean((return_value));
				}
				#endif
				#ifdef __COMPILE_66
				else if (__choose0 == 67)
				{
				//AddStmtAndReplaceAtomKind
				convert_to_boolean((this_ptr));
				}
				#endif
				#ifdef __COMPILE_67
				else if (__choose0 == 68)
				{
				//AddStmtAndReplaceAtomKind
				convert_to_boolean((what));
				}
				#endif
				#ifdef __COMPILE_68
				else if (__choose0 == 69)
				{
				//AddStmtAndReplaceAtomKind
				convert_to_boolean((zcontext));
				}
				#endif
				#ifdef __COMPILE_69
				else if (__choose0 == 70)
				{
				//AddStmtAndReplaceAtomKind
				convert_to_boolean((zfinfo));
				}
				#endif
				#ifdef __COMPILE_70
				else if (__choose0 == 71)
				{
				//AddStmtAndReplaceAtomKind
				finfo = (finfo);
				}
				#endif
				#ifdef __COMPILE_71
				else if (__choose0 == 72)
				{
				//AddStmtAndReplaceAtomKind
				gc_remove_zval_from_buffer((object));
				}
				#endif
				#ifdef __COMPILE_72
				else if (__choose0 == 73)
				{
				//AddStmtAndReplaceAtomKind
				gc_remove_zval_from_buffer((return_value));
				}
				#endif
				#ifdef __COMPILE_73
				else if (__choose0 == 74)
				{
				//AddStmtAndReplaceAtomKind
				gc_remove_zval_from_buffer((this_ptr));
				}
				#endif
				#ifdef __COMPILE_74
				else if (__choose0 == 75)
				{
				//AddStmtAndReplaceAtomKind
				gc_remove_zval_from_buffer((what));
				}
				#endif
				#ifdef __COMPILE_75
				else if (__choose0 == 76)
				{
				//AddStmtAndReplaceAtomKind
				gc_remove_zval_from_buffer((zcontext));
				}
				#endif
				#ifdef __COMPILE_76
				else if (__choose0 == 77)
				{
				//AddStmtAndReplaceAtomKind
				gc_remove_zval_from_buffer((zfinfo));
				}
				#endif
				#ifdef __COMPILE_77
				else if (__choose0 == 78)
				{
				//AddStmtAndReplaceAtomKind
				gc_zval_check_possible_root(((object)));
				}
				#endif
				#ifdef __COMPILE_78
				else if (__choose0 == 79)
				{
				//AddStmtAndReplaceAtomKind
				gc_zval_check_possible_root(((return_value)));
				}
				#endif
				#ifdef __COMPILE_79
				else if (__choose0 == 80)
				{
				//AddStmtAndReplaceAtomKind
				gc_zval_check_possible_root(((this_ptr)));
				}
				#endif
				#ifdef __COMPILE_80
				else if (__choose0 == 81)
				{
				//AddStmtAndReplaceAtomKind
				gc_zval_check_possible_root(((what)));
				}
				#endif
				#ifdef __COMPILE_81
				else if (__choose0 == 82)
				{
				//AddStmtAndReplaceAtomKind
				gc_zval_check_possible_root(((zcontext)));
				}
				#endif
				#ifdef __COMPILE_82
				else if (__choose0 == 83)
				{
				//AddStmtAndReplaceAtomKind
				gc_zval_check_possible_root(((zfinfo)));
				}
				#endif
				#ifdef __COMPILE_83
				else if (__choose0 == 84)
				{
				//AddStmtAndReplaceAtomKind
				gc_zval_possible_root((object));
				}
				#endif
				#ifdef __COMPILE_84
				else if (__choose0 == 85)
				{
				//AddStmtAndReplaceAtomKind
				gc_zval_possible_root((return_value));
				}
				#endif
				#ifdef __COMPILE_85
				else if (__choose0 == 86)
				{
				//AddStmtAndReplaceAtomKind
				gc_zval_possible_root((this_ptr));
				}
				#endif
				#ifdef __COMPILE_86
				else if (__choose0 == 87)
				{
				//AddStmtAndReplaceAtomKind
				gc_zval_possible_root((what));
				}
				#endif
				#ifdef __COMPILE_87
				else if (__choose0 == 88)
				{
				//AddStmtAndReplaceAtomKind
				gc_zval_possible_root((zcontext));
				}
				#endif
				#ifdef __COMPILE_88
				else if (__choose0 == 89)
				{
				//AddStmtAndReplaceAtomKind
				gc_zval_possible_root((zfinfo));
				}
				#endif
				#ifdef __COMPILE_89
				else if (__choose0 == 90)
				{
				//AddStmtAndReplaceAtomKind
				i_zval_ptr_dtor((object));
				}
				#endif
				#ifdef __COMPILE_90
				else if (__choose0 == 91)
				{
				//AddStmtAndReplaceAtomKind
				i_zval_ptr_dtor((return_value));
				}
				#endif
				#ifdef __COMPILE_91
				else if (__choose0 == 92)
				{
				//AddStmtAndReplaceAtomKind
				i_zval_ptr_dtor((this_ptr));
				}
				#endif
				#ifdef __COMPILE_92
				else if (__choose0 == 93)
				{
				//AddStmtAndReplaceAtomKind
				i_zval_ptr_dtor((what));
				}
				#endif
				#ifdef __COMPILE_93
				else if (__choose0 == 94)
				{
				//AddStmtAndReplaceAtomKind
				i_zval_ptr_dtor((zcontext));
				}
				#endif
				#ifdef __COMPILE_94
				else if (__choose0 == 95)
				{
				//AddStmtAndReplaceAtomKind
				i_zval_ptr_dtor((zfinfo));
				}
				#endif
				#ifdef __COMPILE_95
				else if (__choose0 == 96)
				{
				//AddStmtAndReplaceAtomKind
				le_fileinfo = (-1);
				}
				#endif
				#ifdef __COMPILE_96
				else if (__choose0 == 97)
				{
				//AddStmtAndReplaceAtomKind
				le_fileinfo = (0);
				}
				#endif
				#ifdef __COMPILE_97
				else if (__choose0 == 98)
				{
				//AddStmtAndReplaceAtomKind
				le_fileinfo = (1);
				}
				#endif
				#ifdef __COMPILE_98
				else if (__choose0 == 99)
				{
				//AddStmtAndReplaceAtomKind
				le_fileinfo = (16);
				}
				#endif
				#ifdef __COMPILE_99
				else if (__choose0 == 100)
				{
				//AddStmtAndReplaceAtomKind
				le_fileinfo = (16384);
				}
				#endif
				#ifdef __COMPILE_100
				else if (__choose0 == 101)
				{
				//AddStmtAndReplaceAtomKind
				le_fileinfo = (2);
				}
				#endif
				#ifdef __COMPILE_101
				else if (__choose0 == 102)
				{
				//AddStmtAndReplaceAtomKind
				le_fileinfo = (3);
				}
				#endif
				#ifdef __COMPILE_102
				else if (__choose0 == 103)
				{
				//AddStmtAndReplaceAtomKind
				le_fileinfo = (6);
				}
				#endif
				#ifdef __COMPILE_103
				else if (__choose0 == 104)
				{
				//AddStmtAndReplaceAtomKind
				le_fileinfo = (7);
				}
				#endif
				#ifdef __COMPILE_104
				else if (__choose0 == 105)
				{
				//AddStmtAndReplaceAtomKind
				le_fileinfo = (8);
				}
				#endif
				#ifdef __COMPILE_105
				else if (__choose0 == 106)
				{
				//AddStmtAndReplaceAtomKind
				le_fileinfo = (buffer_len);
				}
				#endif
				#ifdef __COMPILE_106
				else if (__choose0 == 107)
				{
				//AddStmtAndReplaceAtomKind
				le_fileinfo = (ht);
				}
				#endif
				#ifdef __COMPILE_107
				else if (__choose0 == 108)
				{
				//AddStmtAndReplaceAtomKind
				le_fileinfo = (mimetype_emu);
				}
				#endif
				#ifdef __COMPILE_108
				else if (__choose0 == 109)
				{
				//AddStmtAndReplaceAtomKind
				le_fileinfo = (mode);
				}
				#endif
				#ifdef __COMPILE_109
				else if (__choose0 == 110)
				{
				//AddStmtAndReplaceAtomKind
				le_fileinfo = (return_value_used);
				}
				#endif
				#ifdef __COMPILE_110
				else if (__choose0 == 111)
				{
				//AddStmtAndReplaceAtomKind
				magic = (finfo)->magic;
				}
				#endif
				#ifdef __COMPILE_111
				else if (__choose0 == 112)
				{
				//AddStmtAndReplaceAtomKind
				magic = (magic);
				}
				#endif
				#ifdef __COMPILE_112
				else if (__choose0 == 113)
				{
				//AddStmtAndReplaceAtomKind
				magic = finfo && !(1 << 5)->magic;
				}
				#endif
				#ifdef __COMPILE_113
				else if (__choose0 == 114)
				{
				//AddStmtAndReplaceAtomKind
				magic_close((finfo)->magic);
				}
				#endif
				#ifdef __COMPILE_114
				else if (__choose0 == 115)
				{
				//AddStmtAndReplaceAtomKind
				magic_close((magic));
				}
				#endif
				#ifdef __COMPILE_115
				else if (__choose0 == 116)
				{
				//AddStmtAndReplaceAtomKind
				magic_close(magic && !(1 << 5));
				}
				#endif
				#ifdef __COMPILE_116
				else if (__choose0 == 117)
				{
				//AddStmtAndReplaceAtomKind
				memcpy(&finfo_object_handlers && !(1 << 5), zend_get_std_object_handlers(), sizeof(zend_object_handlers));
				}
				#endif
				#ifdef __COMPILE_117
				else if (__choose0 == 118)
				{
				//AddStmtAndReplaceAtomKind
				mode = (-1);
				}
				#endif
				#ifdef __COMPILE_118
				else if (__choose0 == 119)
				{
				//AddStmtAndReplaceAtomKind
				mode = (0);
				}
				#endif
				#ifdef __COMPILE_119
				else if (__choose0 == 120)
				{
				//AddStmtAndReplaceAtomKind
				mode = (1);
				}
				#endif
				#ifdef __COMPILE_120
				else if (__choose0 == 121)
				{
				//AddStmtAndReplaceAtomKind
				mode = (16);
				}
				#endif
				#ifdef __COMPILE_121
				else if (__choose0 == 122)
				{
				//AddStmtAndReplaceAtomKind
				mode = (16384);
				}
				#endif
				#ifdef __COMPILE_122
				else if (__choose0 == 123)
				{
				//AddStmtAndReplaceAtomKind
				mode = (2);
				}
				#endif
				#ifdef __COMPILE_123
				else if (__choose0 == 124)
				{
				//AddStmtAndReplaceAtomKind
				mode = (3);
				}
				#endif
				#ifdef __COMPILE_124
				else if (__choose0 == 125)
				{
				//AddStmtAndReplaceAtomKind
				mode = (6);
				}
				#endif
				#ifdef __COMPILE_125
				else if (__choose0 == 126)
				{
				//AddStmtAndReplaceAtomKind
				mode = (7);
				}
				#endif
				#ifdef __COMPILE_126
				else if (__choose0 == 127)
				{
				//AddStmtAndReplaceAtomKind
				mode = (8);
				}
				#endif
				#ifdef __COMPILE_127
				else if (__choose0 == 128)
				{
				//AddStmtAndReplaceAtomKind
				mode = (buffer_len);
				}
				#endif
				#ifdef __COMPILE_128
				else if (__choose0 == 129)
				{
				//AddStmtAndReplaceAtomKind
				mode = (ht);
				}
				#endif
				#ifdef __COMPILE_129
				else if (__choose0 == 130)
				{
				//AddStmtAndReplaceAtomKind
				mode = (mimetype_emu);
				}
				#endif
				#ifdef __COMPILE_130
				else if (__choose0 == 131)
				{
				//AddStmtAndReplaceAtomKind
				mode = (mode);
				}
				#endif
				#ifdef __COMPILE_131
				else if (__choose0 == 132)
				{
				//AddStmtAndReplaceAtomKind
				mode = (return_value_used);
				}
				#endif
				#ifdef __COMPILE_132
				else if (__choose0 == 133)
				{
				//AddStmtAndReplaceAtomKind
				php_error_docref0(((void *)0), (1 << 1L), "Failed identify data %d:%s", magic_errno((magic)), magic_error(magic));
				}
				#endif
				#ifdef __COMPILE_133
				else if (__choose0 == 134)
				{
				//AddStmtAndReplaceAtomKind
				php_error_docref0(((void *)0), (1 << 1L), "Failed identify data %d:%s", magic_errno(magic && !(1 << 5)), magic_error(magic));
				}
				#endif
				#ifdef __COMPILE_134
				else if (__choose0 == 135)
				{
				//AddStmtAndReplaceAtomKind
				php_error_docref0(((void *)0), (1 << 1L), "Failed identify data %d:%s", magic_errno(magic), magic_error((magic)));
				}
				#endif
				#ifdef __COMPILE_135
				else if (__choose0 == 136)
				{
				//AddStmtAndReplaceAtomKind
				php_error_docref0(((void *)0), (1 << 1L), "Failed identify data %d:%s", magic_errno(magic), magic_error(magic && !(1 << 5)));
				}
				#endif
				#ifdef __COMPILE_136
				else if (__choose0 == 137)
				{
				//AddStmtAndReplaceAtomKind
				php_error_docref0(((void *)0), (1 << 1L), "Failed to load magic database at '%s'.", (buffer));
				}
				#endif
				#ifdef __COMPILE_137
				else if (__choose0 == 138)
				{
				//AddStmtAndReplaceAtomKind
				php_error_docref0(((void *)0), (1 << 1L), "Failed to load magic database at '%s'.", (ret_val));
				}
				#endif
				#ifdef __COMPILE_138
				else if (__choose0 == 139)
				{
				//AddStmtAndReplaceAtomKind
				php_error_docref0(((void *)0), (1 << 1L), "Failed to load magic database at '%s'.", (tmp2));
				}
				#endif
				#ifdef __COMPILE_139
				else if (__choose0 == 140)
				{
				//AddStmtAndReplaceAtomKind
				php_error_docref0(((void *)0), (1 << 1L), "Failed to set option '%ld' %d:%s", (finfo)->options, magic_errno(magic), magic_error(magic));
				}
				#endif
				#ifdef __COMPILE_140
				else if (__choose0 == 141)
				{
				//AddStmtAndReplaceAtomKind
				php_error_docref0(((void *)0), (1 << 1L), "Failed to set option '%ld' %d:%s", finfo && !(1 << 5)->options, magic_errno(magic), magic_error(magic));
				}
				#endif
				#ifdef __COMPILE_141
				else if (__choose0 == 142)
				{
				//AddStmtAndReplaceAtomKind
				php_error_docref0(((void *)0), (1 << 1L), "Failed to set option '%ld' %d:%s", finfo->options, magic_errno((magic)), magic_error(magic));
				}
				#endif
				#ifdef __COMPILE_142
				else if (__choose0 == 143)
				{
				//AddStmtAndReplaceAtomKind
				php_error_docref0(((void *)0), (1 << 1L), "Failed to set option '%ld' %d:%s", finfo->options, magic_errno(magic && !(1 << 5)), magic_error(magic));
				}
				#endif
				#ifdef __COMPILE_143
				else if (__choose0 == 144)
				{
				//AddStmtAndReplaceAtomKind
				php_error_docref0(((void *)0), (1 << 1L), "Failed to set option '%ld' %d:%s", finfo->options, magic_errno(magic), magic_error((magic)));
				}
				#endif
				#ifdef __COMPILE_144
				else if (__choose0 == 145)
				{
				//AddStmtAndReplaceAtomKind
				php_error_docref0(((void *)0), (1 << 1L), "Failed to set option '%ld' %d:%s", finfo->options, magic_errno(magic), magic_error(magic && !(1 << 5)));
				}
				#endif
				#ifdef __COMPILE_145
				else if (__choose0 == 146)
				{
				//AddStmtAndReplaceAtomKind
				php_error_docref0(((void *)0), (1 << 1L), "Failed to set option '%ld' %d:%s", options && !(1 << 5), magic_errno(magic), magic_error(magic));
				}
				#endif
				#ifdef __COMPILE_146
				else if (__choose0 == 147)
				{
				//AddStmtAndReplaceAtomKind
				php_error_docref0(((void *)0), (1 << 1L), "Failed to set option '%ld' %d:%s", options, magic_errno((magic)), magic_error(magic));
				}
				#endif
				#ifdef __COMPILE_147
				else if (__choose0 == 148)
				{
				//AddStmtAndReplaceAtomKind
				php_error_docref0(((void *)0), (1 << 1L), "Failed to set option '%ld' %d:%s", options, magic_errno(magic && !(1 << 5)), magic_error(magic));
				}
				#endif
				#ifdef __COMPILE_148
				else if (__choose0 == 149)
				{
				//AddStmtAndReplaceAtomKind
				php_error_docref0(((void *)0), (1 << 1L), "Failed to set option '%ld' %d:%s", options, magic_errno(magic), magic_error((magic)));
				}
				#endif
				#ifdef __COMPILE_149
				else if (__choose0 == 150)
				{
				//AddStmtAndReplaceAtomKind
				php_error_docref0(((void *)0), (1 << 1L), "Failed to set option '%ld' %d:%s", options, magic_errno(magic), magic_error(magic && !(1 << 5)));
				}
				#endif
				#ifdef __COMPILE_150
				else if (__choose0 == 151)
				{
				//AddStmtAndReplaceAtomKind
				php_error_docref0(((void *)0), (1 << 1L), "File or path not found '%s'", (buffer));
				}
				#endif
				#ifdef __COMPILE_151
				else if (__choose0 == 152)
				{
				//AddStmtAndReplaceAtomKind
				php_error_docref0(((void *)0), (1 << 1L), "File or path not found '%s'", (ret_val));
				}
				#endif
				#ifdef __COMPILE_152
				else if (__choose0 == 153)
				{
				//AddStmtAndReplaceAtomKind
				php_error_docref0(((void *)0), (1 << 1L), "File or path not found '%s'", (tmp2));
				}
				#endif
				#ifdef __COMPILE_153
				else if (__choose0 == 154)
				{
				//AddStmtAndReplaceAtomKind
				php_error_docref0(((void *)0), (1 << 1L), "File or path not found '%s'", buffer && !(1 << 5));
				}
				#endif
				#ifdef __COMPILE_154
				else if (__choose0 == 155)
				{
				//AddStmtAndReplaceAtomKind
				ret_val = (buffer);
				}
				#endif
				#ifdef __COMPILE_155
				else if (__choose0 == 156)
				{
				//AddStmtAndReplaceAtomKind
				ret_val = (ret_val);
				}
				#endif
				#ifdef __COMPILE_156
				else if (__choose0 == 157)
				{
				//AddStmtAndReplaceAtomKind
				ret_val = (tmp2);
				}
				#endif
				#ifdef __COMPILE_157
				else if (__choose0 == 158)
				{
				//AddStmtAndReplaceAtomKind
				ret_val = mime_directory && !(1 << 5);
				}
				#endif
				#ifdef __COMPILE_158
				else if (__choose0 == 159)
				{
				//AddStmtAndReplaceAtomKind
				wrap = (wrap);
				}
				#endif
				#ifdef __COMPILE_159
				else if (__choose0 == 160)
				{
				//AddStmtAndReplaceAtomKind
				wrap = php_stream_locate_url_wrapper((buffer), &tmp2, 0);
				}
				#endif
				#ifdef __COMPILE_160
				else if (__choose0 == 161)
				{
				//AddStmtAndReplaceAtomKind
				wrap = php_stream_locate_url_wrapper((ret_val), &tmp2, 0);
				}
				#endif
				#ifdef __COMPILE_161
				else if (__choose0 == 162)
				{
				//AddStmtAndReplaceAtomKind
				wrap = php_stream_locate_url_wrapper((tmp2), &tmp2, 0);
				}
				#endif
				#ifdef __COMPILE_162
				else if (__choose0 == 163)
				{
				//AddStmtAndReplaceAtomKind
				wrap = php_stream_locate_url_wrapper(buffer && !(1 << 5), &tmp2, 0);
				}
				#endif
				#ifdef __COMPILE_163
				else if (__choose0 == 164)
				{
				//AddStmtAndReplaceAtomKind
				wrap = php_stream_locate_url_wrapper(buffer, &(buffer), 0);
				}
				#endif
				#ifdef __COMPILE_164
				else if (__choose0 == 165)
				{
				//AddStmtAndReplaceAtomKind
				wrap = php_stream_locate_url_wrapper(buffer, &(ret_val), 0);
				}
				#endif
				#ifdef __COMPILE_165
				else if (__choose0 == 166)
				{
				//AddStmtAndReplaceAtomKind
				wrap = php_stream_locate_url_wrapper(buffer, &(tmp2), 0);
				}
				#endif
				#ifdef __COMPILE_166
				else if (__choose0 == 167)
				{
				//AddStmtAndReplaceAtomKind
				wrap = php_stream_locate_url_wrapper(buffer, &tmp2 && !(1 << 5), 0);
				}
				#endif
				#ifdef __COMPILE_167
				else if (__choose0 == 168)
				{
				//AddStmtAndReplaceAtomKind
				zval_unset_isref_p((object));
				}
				#endif
				#ifdef __COMPILE_168
				else if (__choose0 == 169)
				{
				//AddStmtAndReplaceAtomKind
				zval_unset_isref_p((return_value));
				}
				#endif
				#ifdef __COMPILE_169
				else if (__choose0 == 170)
				{
				//AddStmtAndReplaceAtomKind
				zval_unset_isref_p((this_ptr));
				}
				#endif
				#ifdef __COMPILE_170
				else if (__choose0 == 171)
				{
				//AddStmtAndReplaceAtomKind
				zval_unset_isref_p((what));
				}
				#endif
				#ifdef __COMPILE_171
				else if (__choose0 == 172)
				{
				//AddStmtAndReplaceAtomKind
				zval_unset_isref_p((zcontext));
				}
				#endif
				#ifdef __COMPILE_172
				else if (__choose0 == 173)
				{
				//AddStmtAndReplaceAtomKind
				zval_unset_isref_p((zfinfo));
				}
				#endif
				#ifdef __COMPILE_173
				else if (__choose0 == 174)
				{
				//AddStmtKind
				(executor_globals.argument_stack) = zend_vm_stack_new_page(((16 * 1024) - 16));
				}
				#endif
				#ifdef __COMPILE_174
				else if (__choose0 == 175)
				{
				//AddStmtKind
				buffer_len = (*what).value.str.len;
				}
				#endif
				#ifdef __COMPILE_175
				else if (__choose0 == 176)
				{
				//AddStmtKind
				exit(1);
				}
				#endif
				#ifdef __COMPILE_176
				else if (__choose0 == 177)
				{
				//AddStmtKind
				finfo = (struct php_fileinfo *)zend_fetch_resource(&zfinfo, -1, "file_info", ((void *)0), 1, le_fileinfo);
				}
				#endif
				#ifdef __COMPILE_177
				else if (__choose0 == 178)
				{
				//AddStmtKind
				magic = finfo->magic;
				}
				#endif
				#ifdef __COMPILE_178
				else if (__choose0 == 179)
				{
				//AddStmtKind
				magic = magic_open(16);
				}
				#endif
				#ifdef __COMPILE_179
				else if (__choose0 == 180)
				{
				//AddStmtKind
				magic_close(magic);
				}
				#endif
				#ifdef __COMPILE_180
				else if (__choose0 == 181)
				{
				//AddStmtKind
				memcpy(&finfo_object_handlers, zend_get_std_object_handlers(), sizeof(zend_object_handlers));
				}
				#endif
				#ifdef __COMPILE_181
				else if (__choose0 == 182)
				{
				//AddStmtKind
				mode = 2;
				}
				#endif
				#ifdef __COMPILE_182
				else if (__choose0 == 183)
				{
				//AddStmtKind
				php_error_docref0(((void *)0), (1 << 1L), "Empty filename or path");
				}
				#endif
				#ifdef __COMPILE_183
				else if (__choose0 == 184)
				{
				//AddStmtKind
				php_error_docref0(((void *)0), (1 << 1L), "Failed identify data %d:%s", magic_errno(magic), magic_error(magic));
				}
				#endif
				#ifdef __COMPILE_184
				else if (__choose0 == 185)
				{
				//AddStmtKind
				php_error_docref0(((void *)0), (1 << 1L), "Failed to load magic database.");
				}
				#endif
				#ifdef __COMPILE_185
				else if (__choose0 == 186)
				{
				//AddStmtKind
				php_error_docref0(((void *)0), (1 << 1L), "Failed to set option '%ld' %d:%s", finfo->options, magic_errno(magic), magic_error(magic));
				}
				#endif
				#ifdef __COMPILE_186
				else if (__choose0 == 187)
				{
				//AddStmtKind
				php_error_docref0(((void *)0), (1 << 1L), "Failed to set option '%ld' %d:%s", options, magic_errno(magic), magic_error(magic));
				}
				#endif
				#ifdef __COMPILE_187
				else if (__choose0 == 188)
				{
				//AddStmtKind
				php_error_docref0(((void *)0), (1 << 1L), "File or path not found '%s'", buffer);
				}
				#endif
				#ifdef __COMPILE_188
				else if (__choose0 == 189)
				{
				//AddStmtKind
				php_error_docref0(((void *)0), (1 << 1L), "The invalid fileinfo object.");
				}
				#endif
				#ifdef __COMPILE_189
				else if (__choose0 == 190)
				{
				//AddStmtKind
				php_info_print_table_end();
				}
				#endif
				#ifdef __COMPILE_190
				else if (__choose0 == 191)
				{
				//AddStmtKind
				php_info_print_table_header(2, "fileinfo support", "enabled");
				}
				#endif
				#ifdef __COMPILE_191
				else if (__choose0 == 192)
				{
				//AddStmtKind
				php_info_print_table_row(2, "version", "1.0.5-dev");
				}
				#endif
				#ifdef __COMPILE_192
				else if (__choose0 == 193)
				{
				//AddStmtKind
				php_info_print_table_start();
				}
				#endif
				#ifdef __COMPILE_193
				else if (__choose0 == 194)
				{
				//AddStmtKind
				ret_val = (char *)magic_buffer(magic, buffer, buffer_len);
				}
				#endif
				#ifdef __COMPILE_194
				else if (__choose0 == 195)
				{
				//AddStmtKind
				ret_val = mime_directory;
				}
				#endif
				#ifdef __COMPILE_195
				else if (__choose0 == 196)
				{
				//AddStmtKind
				wrap = php_stream_locate_url_wrapper(buffer, &tmp2, 0);
				}
				#endif
				#ifdef __COMPILE_196
				else if (__choose0 == 197)
				{
				//AddStmtKind
				zend_error((1 << 3L), "A non well formed numeric value encountered");
				}
				#endif
				#ifdef __COMPILE_197
				else if (__choose0 == 198)
				{
				//IfExitKind
				if (__is_neg("0-198", "L483", 18, &(return_value), sizeof (return_value), &(buffer),
							 sizeof (buffer), &(ret_val), sizeof (ret_val), &(tmp2), sizeof (tmp2), &(wrap),
							 sizeof (wrap), &(magic), sizeof (magic), &(zcontext), sizeof (zcontext), &(what),
							 sizeof (what), &(buffer_len), sizeof (buffer_len), &(mode), sizeof (mode), &(options),
							 sizeof (options), &(finfo), sizeof (finfo), &(zfinfo), sizeof (zfinfo), &(le_fileinfo),
							 sizeof (le_fileinfo), &(ht), sizeof (ht), &(mimetype_emu), sizeof (mimetype_emu), &(object),
							 sizeof (object), &(this_ptr), sizeof (this_ptr)))
				    goto clean;
				}
				#endif
				#ifdef __COMPILE_198
				else if (__choose0 == 199)
				{
				//IfExitKind
				if (__is_neg("0-199", "L483", 18, &(return_value), sizeof (return_value), &(buffer),
							 sizeof (buffer), &(ret_val), sizeof (ret_val), &(tmp2), sizeof (tmp2), &(wrap),
							 sizeof (wrap), &(magic), sizeof (magic), &(zcontext), sizeof (zcontext), &(what),
							 sizeof (what), &(buffer_len), sizeof (buffer_len), &(mode), sizeof (mode), &(options),
							 sizeof (options), &(finfo), sizeof (finfo), &(zfinfo), sizeof (zfinfo), &(le_fileinfo),
							 sizeof (le_fileinfo), &(ht), sizeof (ht), &(mimetype_emu), sizeof (mimetype_emu), &(object),
							 sizeof (object), &(this_ptr), sizeof (this_ptr)))
				    goto common;
				}
				#endif
				#ifdef __COMPILE_199
				else if (__choose0 == 200)
				{
				//IfExitKind
				if (__is_neg("0-200", "L483", 18, &(return_value), sizeof (return_value), &(buffer),
							 sizeof (buffer), &(ret_val), sizeof (ret_val), &(tmp2), sizeof (tmp2), &(wrap),
							 sizeof (wrap), &(magic), sizeof (magic), &(zcontext), sizeof (zcontext), &(what),
							 sizeof (what), &(buffer_len), sizeof (buffer_len), &(mode), sizeof (mode), &(options),
							 sizeof (options), &(finfo), sizeof (finfo), &(zfinfo), sizeof (zfinfo), &(le_fileinfo),
							 sizeof (le_fileinfo), &(ht), sizeof (ht), &(mimetype_emu), sizeof (mimetype_emu), &(object),
							 sizeof (object), &(this_ptr), sizeof (this_ptr)))
				    return;
				}
				#endif
				int __choose1 = __choose("__SWITCH1");
				if (__choose1 == 0)
				{
				goto clean;
				
				}
				#ifdef __COMPILE_200
				else if (__choose1 == 1)
				{
				//GuardKind
				if (!__is_neg("1-1", "L483", 18, &(return_value), sizeof (return_value), &(buffer), sizeof (buffer), &(ret_val), sizeof (ret_val), &(tmp2), sizeof (tmp2), &(wrap), sizeof (wrap), &(magic), sizeof (magic), &(zcontext), sizeof (zcontext), &(what), sizeof (what), &(buffer_len), sizeof (buffer_len), &(mode), sizeof (mode), &(options), sizeof (options), &(finfo), sizeof (finfo), &(zfinfo), sizeof (zfinfo), &(le_fileinfo), sizeof (le_fileinfo), &(ht), sizeof (ht), &(mimetype_emu), sizeof (mimetype_emu), &(object), sizeof (object), &(this_ptr), sizeof (this_ptr)))
				    goto clean;
				
				}
				#endif
				}
			}

			if (php_sys_stat(buffer, &sb) == 0) {
					  if (sb.st_mode & _S_IFDIR) {
								 ret_val = mime_directory;
								 goto common;
					  }
			} else {
				php_error_docref(NULL TSRMLS_CC, E_WARNING, "File or path not found '%s'", buffer);
				RETVAL_FALSE;
				goto clean;
			}

			wrap = php_stream_locate_url_wrapper(buffer, &tmp2, 0 TSRMLS_CC);

			if (wrap) {
				php_stream_context *context = php_stream_context_from_zval(zcontext, 0);
#if PHP_API_VERSION < 20100412
				php_stream *stream = php_stream_open_wrapper_ex(buffer, "rb", ENFORCE_SAFE_MODE | REPORT_ERRORS, NULL, context);
#else
				php_stream *stream = php_stream_open_wrapper_ex(buffer, "rb", REPORT_ERRORS, NULL, context);
#endif

				if (!stream) {
					RETVAL_FALSE;
					goto clean;
				}

				ret_val = (char *)magic_stream(magic, stream);
				php_stream_close(stream);
			}
			break;
		}

		default:
			php_error_docref(NULL TSRMLS_CC, E_WARNING, "Can only process string or stream arguments");
	}

common:
	if (ret_val) {
		RETVAL_STRING(ret_val, 1);
	} else {
		php_error_docref(NULL TSRMLS_CC, E_WARNING, "Failed identify data %d:%s", magic_errno(magic), magic_error(magic));
		RETVAL_FALSE;
	}

clean:
	if (mimetype_emu) {
		magic_close(magic);
	}

	/* Restore options */
	if (options) {
		FINFO_SET_OPTION(magic, finfo->options)
	}
	return;
}
/* }}} */

/* {{{ proto string finfo_file(resource finfo, char *file_name [, int options [, resource context]])
   Return information about a file. */
PHP_FUNCTION(finfo_file)
{
	_php_finfo_get_type(INTERNAL_FUNCTION_PARAM_PASSTHRU, FILEINFO_MODE_FILE, 0);
}
/* }}} */

/* {{{ proto string finfo_buffer(resource finfo, char *string [, int options [, resource context]])
   Return infromation about a string buffer. */
PHP_FUNCTION(finfo_buffer)
{
	_php_finfo_get_type(INTERNAL_FUNCTION_PARAM_PASSTHRU, FILEINFO_MODE_BUFFER, 0);
}
/* }}} */

/* {{{ proto string mime_content_type(string filename|resource stream)
   Return content-type for file */
PHP_FUNCTION(mime_content_type)
{
	_php_finfo_get_type(INTERNAL_FUNCTION_PARAM_PASSTHRU, -1, 1);
}
/* }}} */


/*
 * Local variables:
 * tab-width: 4
 * c-basic-offset: 4
 * End:
 * vim600: noet sw=4 ts=4 fdm=marker
 * vim<600: noet sw=4 ts=4
 */
